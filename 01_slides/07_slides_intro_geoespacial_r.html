<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introdu√ß√£o ao uso de dados geoespaciais no R    </title>
    <meta charset="utf-8" />
    <meta name="author" content="Maur√≠cio H. Vancine   Milton C. Ribeiro" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Introdu√ß√£o ao uso de dados geoespaciais no R <br><br><br>
## 7 Estrutura e manipula√ß√£o de dados vetoriais
### Maur√≠cio H. Vancine <br> Milton C. Ribeiro
### UNESP - Rio Claro <br> Laborat√≥rio de Ecologia Espacial e Conserva√ß√£o (LEEC)
### 25/10/2021-05/11/2021

---




class: clear
background-image: url(img/geo_vector_sf_allison.png)
background-size: 800px

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[@allison_horst](https://twitter.com/allison_horst)

---

background-image: url(img/r_spatial.jpeg)
background-size: 350px
background-position: 80% 65%

# 7 Estrutura e manipula√ß√£o de vetores

## T√≥picos

1. Principais pacotes
1. Geometrias sf
1. Classes sf
1. Importar dados vetoriais
1. Descri√ß√£o de objetos sf
1. Converter objetos para sf
1. Converter CRS de objetos sf
1. Opera√ß√µes de objetos sf
1. Exportar objetos sf

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[Lovelace et al. (2020)](https://geocompr.robinlovelace.net/)

---

# 7¬¥ Estrutura e manipula√ß√£o de vetores

## Script

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

## .center[`07_script_intro_geoespacial_r.R`]

---

background-image: url(img/geo_sp_dep.png)
background-size: 700px
background-position: 50% 75%

# 1. Principais pacotes

## Pacote sp


```r
# sp
install.packages("sp")
library(sp)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[sp](https://github.com/edzer/sp/)

---

background-image: url(img/package_sf.gif)
background-size: 350px
background-position: 50% 80%

# 1. Principais pacotes

## Pacote sf


```r
# sf
install.packages("sf")
library(sf)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[sf](https://r-spatial.github.io/sf/)

---

background-image: url(img/cheatsheet_sf.png)
background-size: 500px
background-position: 50% 70%

# 1. Principais pacotes

## Pacote sf

### Spatial manipulation with sf cheat sheets

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[Spatial manipulation with sf](https://raw.githubusercontent.com/rstudio/cheatsheets/master/sf.pdf)

---

background-image: url(img/geo_sf_article.png)
background-size: 500px
background-position: 50% 85%

# 1. Principais pacotes

## Pacote sf

### Artigo
&gt; - Pebesma, Edzer. ["Simple Features for R: Standardized Support for Spatial Vector Data."](https://journal.r-project.org/archive/2018/RJ-2018-009/) The R Journal 10.01 (2018): 439-446.

---

background-image: url(img/geo_sf_deps.png)
background-size: 700px
background-position: 50% 85%

# 1. Principais pacotes

## Pacote sf

### Depend√™ncias de outros pacotes

---

background-image: url(img/geo_sf_methods.png)
background-size: 600px
background-position: 50% 80%

# 1. Principais pacotes

## Pacote sf

### M√©todos

---

background-image: url(img/geo_sf_functions.png)
background-size: 700px
background-position: 50% 70%

# 1. Principais pacotes

## Pacote sf

### Fun√ß√µes

---

# 1. Principais pacotes

## Pacote sf - Descri√ß√£o

### **R√°pida importa√ß√£o e exporta√ß√£o** de dados

--

### **Desempenho aprimorado** de mapas e gr√°ficos

--

### Objetos `sf` podem ser tratados como `data frames` (`tibbles`) na maioria das **opera√ß√µes de manipula√ß√£o**

--

### As fun√ß√µes `sf` **podem ser combinadas** usando o operador `%&gt;%` e funcionam bem com `tidyverse`

--

### Os nomes das fun√ß√µes sf s√£o relativamente **consistentes e intuitivos** (todos come√ßam com `sf::st_`)

---

background-image: url(img/geo_vetor_dados.png), url(img/geo_vector_types.jpg)
background-size: 650px, 450px
background-position: 8% 60%, 95% 65%

# 2. Tipos de geometrias sf

## Tipos de dados geoespaciais vetoriais

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[Shin et al. (2017)](https://catalog.flatworldknowledge.com/catalog/editions/campbell_2_1-essentials-of-geographic-information-systems-2-1),
[Silva et al. (in prep.)](https://paternogbc.github.io/livro_aer/)

---

background-image: url(img/geo_vector_sf_types.png), url(img/geo_sf_geometries.png)
background-size: 400px, 550px
background-position: 15% 60%, 85% 60%

# 2. Tipos de geometrias sf

## Tipos de geometrias

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[Lovelace et al. (2020)](https://geocompr.robinlovelace.net/)

---

# 3. Classes sf

## O pacote sf define um sistema de tr√™s classes hier√°rquicas

&lt;br&gt;

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Classes &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Hierarquia &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Informa√ß√£o &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1. Simple feature geometries (`sfg`) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Geometria &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Tipo de geometria e coordenadas &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2. Simple feature columns (`sfc`) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Coluna de geometria &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Conjunto de `sfg` + CRS &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3. Simple feature (`sf`) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Camada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Conjunto de `sfc` + atributos &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;br&gt;

-   1. Classe `sfg` - uma geometria √∫nica
-   2. Classe `sfc` - uma coluna de geometria, que √© um conjunto de geometrias `sfg` e informa√ß√µes Sistema de Refer√™ncia de Coordenadas (do ingl√™s *Coordinate Reference Systems - CRS*)
-   3. Classe `sf` - uma camada, que √© uma coluna de geometria `sfc` dentro de um data frame com atributos n√£o espaciais (tabela de atributos)

---

# 3. Classes sf

## **1. Simple feature geometries (`sfg`)**

### A classe `sfg` representa os **diferentes tipos de geometrias** no R: ponto, linha, pol√≠gono (e seus equivalentes ‚Äòmulti‚Äô) ou cole√ß√£o de geometrias

--

#### Fun√ß√µes para criar geometrias da classe `sfg`:


```r
# simple
sf::st_point()
sf::st_linestring()
sf::st_polygon()

# multi
sf::st_multipoint()
sf::st_multilinestring()
sf::st_multipolygon()

# collections
sf::st_geometrycollection()
```

---

# 3. Classes sf

## **1. Simple feature geometries (`sfg`)**

### Os objetos `sfg` podem ser **criados** a partir de **tr√™s tipos de dados R base**:

&lt;br&gt;

### 1. **vetor num√©rico**: um √∫nico ponto
### 2. **matriz**: um conjunto de pontos, onde cada linha representa um ponto, um multiponto ou uma linha
### 3. **lista**: uma cole√ß√£o de objetos como matrizes, cadeias multilinha ou cole√ß√µes de geometrias

---

# 3. Classes sf

## **1. Simple feature geometries (`sfg`)**


```r
# vector - point
vec &lt;- c(5, 2)
po &lt;- sf::st_point(vec)
po
```


```r
# plot
plot(po, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-6-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **1. Simple feature geometries (`sfg`)**


```r
# matrix - multipoint
multipoint_matrix &lt;- rbind(c(5, 2), c(1, 3), c(3, 4), c(3, 2))
po_mul &lt;- sf::st_multipoint(multipoint_matrix)
po_mul
```


```r
# plot
plot(po_mul, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-8-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **1. Simple feature geometries (`sfg`)**


```r
# matrix - linestring
multipoint_matrix &lt;- rbind(c(5, 2), c(1, 3), c(3, 4), c(3, 2))
lin &lt;- sf::st_linestring(multipoint_matrix)
lin
```


```r
# plot
plot(lin, lwd = 2, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-10-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **1. Simple feature geometries (`sfg`)**


```r
# list - polygon
polygon_list &lt;- list(rbind(c(1, 5), c(2, 2), c(4, 1), c(4, 4), c(1, 5)))
pol &lt;- sf::st_polygon(polygon_list)
pol
```


```r
# plot
plot(pol, col = "gray", axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-12-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

### Uma **lista de objetos** `sfg` que possui o **mesmo CSR** (*Coordinate Reference System*)

--

### Pode conter objetos da **mesma geometria** ou de **geometrias diferentes**

--

### Fun√ß√µes para **criar** a classe `sfc` e verificar o **tipo da geometria e CRS**:

```r
sf::st_sfc()
sf::st_geometry_type()
sf::st_crs()
```

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

```r
# sfc point
point1 &lt;- sf::st_point(c(5, 2))
point2 &lt;- sf::st_point(c(1, 3))
points_sfc &lt;- sf::st_sfc(point1, point2)
points_sfc
```

```
## Geometry set for 2 features 
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 1 ymin: 2 xmax: 5 ymax: 3
## CRS:           NA
```


```r
sf::st_geometry_type(points_sfc)
```

```
## [1] POINT POINT
## 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING MULTIPOLYGON GEOMETRYCOLLECTION CIRCULARSTRING ... TRIANGLE
```

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

```r
# plot
plot(points_sfc, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-16-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

```r
# sfc geometry
po_pol_sfc &lt;- sf::st_sfc(po, pol)
po_pol_sfc
```

```
## Geometry set for 2 features 
## Geometry type: GEOMETRY
## Dimension:     XY
## Bounding box:  xmin: 1 ymin: 1 xmax: 5 ymax: 5
## CRS:           NA
```


```r
sf::st_geometry_type(po_pol_sfc)
```

```
## [1] POINT   POLYGON
## 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING MULTIPOLYGON GEOMETRYCOLLECTION CIRCULARSTRING ... TRIANGLE
```

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

```r
# plot
plot(po_pol_sfc, pch = 20, cex = 4, lwd = 2, col = "gray", axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-19-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

### Coordinate Reference Systems (CRS) - EPSG

```r
# epsg definition
points_sfc_wgs &lt;- sf::st_sfc(point1, point2, crs = 4326)
sf::st_crs(points_sfc_wgs)
```

```
## Coordinate Reference System:
##   User input: EPSG:4326 
##   wkt:
## GEOGCRS["WGS 84",
##     DATUM["World Geodetic System 1984",
##         ELLIPSOID["WGS 84",6378137,298.257223563,
##             LENGTHUNIT["metre",1]]],
##     PRIMEM["Greenwich",0,
##         ANGLEUNIT["degree",0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS["geodetic latitude (Lat)",north,
##             ORDER[1],
##             ANGLEUNIT["degree",0.0174532925199433]],
##         AXIS["geodetic longitude (Lon)",east,
##             ORDER[2],
##             ANGLEUNIT["degree",0.0174532925199433]],
##     USAGE[
##         SCOPE["Horizontal component of 3D system."],
##         AREA["World."],
##         BBOX[-90,-180,90,180]],
##     ID["EPSG",4326]]
```

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

### Coordinate Reference Systems (CRS) - proj4string

```r
# proj4string definition
points_sfc_wgs &lt;- sf::st_sfc(point1, point2, crs = "+proj=longlat +datum=WGS84 +no_defs")
sf::st_crs(points_sfc_wgs)
```

```
## Coordinate Reference System:
##   User input: +proj=longlat +datum=WGS84 +no_defs 
##   wkt:
## GEOGCRS["unknown",
##     DATUM["World Geodetic System 1984",
##         ELLIPSOID["WGS 84",6378137,298.257223563,
##             LENGTHUNIT["metre",1]],
##         ID["EPSG",6326]],
##     PRIMEM["Greenwich",0,
##         ANGLEUNIT["degree",0.0174532925199433],
##         ID["EPSG",8901]],
##     CS[ellipsoidal,2],
##         AXIS["longitude",east,
##             ORDER[1],
##             ANGLEUNIT["degree",0.0174532925199433,
##                 ID["EPSG",9122]]],
##         AXIS["latitude",north,
##             ORDER[2],
##             ANGLEUNIT["degree",0.0174532925199433,
##                 ID["EPSG",9122]]]]
```

---

# 3. Classes sf

## **2. Simple feature columns (`sfc`)**

```r
# plot
plot(points_sfc_wgs, pch = 20, cex = 4, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-22-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **3. Simple feature (`sf`)**

### A classe sf (simple features) s√£o *data frames* com **atributos espaciais** armazenados em uma coluna, geralmente chamada de **geometry** 

--

### Essa **dualidade** √© central para o conceito de **simple features**: na maioria das vezes, um sf pode **ser tratado e se comporta** como um *data frame *

--

### **Simple features** s√£o, em ess√™ncia, *data frames* com uma **extens√£o espacial**

---

# 3. Classes sf

## **3. Simple feature (`sf`)**

### Criar um objeto sf

```r
rc_point &lt;- sf::st_point(c(-47.57, -22.39))         # `sfg` object
rc_geom &lt;- sf::st_sfc(rc_point, crs = 4326)        # `sfc` object
rc_attrib &lt;- data.frame(                       # data frame object
  name = "Rio Claro",
  temperature = 19,
  date = as.Date("2020-10-13")
)
rc_sf &lt;- sf::st_sf(rc_attrib, geometry = rc_geom)  # sf object
```

---

# 3. Classes sf

## **3. Simple feature (`sf`)**

### A estrutura de um objeto sf

```r
rc_sf
```

```
## Simple feature collection with 1 feature and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -47.57 ymin: -22.39 xmax: -47.57 ymax: -22.39
## Geodetic CRS:  WGS 84
##        name temperature       date              geometry
## 1 Rio Claro          19 2020-10-13 POINT (-47.57 -22.39)
```

### As duas classes do objeto sf

```r
class(rc_sf)
```

```
## [1] "sf"         "data.frame"
```

---

# 3. Classes sf

## **3. Simple feature (`sf`)**

```r
# plot
plot(rc_sf[1], pch = 20, cex = 4, axes = TRUE, graticule = TRUE) # rc_sf[1] - plotar a primeira coluna
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-26-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **3. Simple feature (`sf`)**

```r
# plot
plot(rc_sf[2], pch = 20, cex = 4, axes = TRUE, graticule = TRUE) # rc_sf[2] - plotar a segunda coluna
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-27-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 3. Classes sf

## **3. Simple feature (`sf`)**

```r
# plot
plot(rc_sf$geometry, pch = 20, cex = 4, axes = TRUE, graticule = TRUE) # rc_sf$geometry - plotar apenas a geometria
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-28-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_data_fbds.png)
background-size: 500px
background-position: 50% 90%

# 4. Importar dados vetoriais

### Funda√ß√£o Brasileira Desenvolvimento Sustent√°vel (FBDS)

Em 2015, a FBDS deu in√≠cio ao *Projeto de Mapeamento em Alta Resolu√ß√£o dos Biomas Brasileiros*: 
- Cobertura da terra
- Hidrografia (nascentes, rios e lagos)
- √Åreas de Preserva√ß√£o Permanente (APP)

O mapeamento foi conclu√≠do para os munic√≠pios dos biomas *Mata Atl√¢ntica e Cerrado*

Site: https://www.fbds.org.br/&lt;br&gt;
Reposit√≥rio: http://geo.fbds.org.br/

---

# 4. Importar dados vetoriais

## Download

### Criar um diret√≥rio 

```r
# create directory
dir.create(here::here("03_dados", "vetor"))
```

--

### Download de **pontos de nascentes** para Rio Claro/SP

```r
# increase time to download
options(timeout = 600)

# download points
for(i in c(".dbf", ".prj", ".shp", ".shx")){
  download.file(url = paste0("http://geo.fbds.org.br/SP/RIO_CLARO/HIDROGRAFIA/SP_3543907_NASCENTES", i),
                destfile = here::here("03_dados", "vetor", paste0("SP_3543907_NASCENTES", i)), mode = "wb")
}
```

---

# 4. Importar dados vetoriais

## Download

### Download de **linhas da hidrografia** para Rio Claro/SP

```r
# download lines
for(i in c(".dbf", ".prj", ".shp", ".shx")){
  download.file(url = paste0("http://geo.fbds.org.br/SP/RIO_CLARO/HIDROGRAFIA/SP_3543907_RIOS_SIMPLES", i),
                destfile = here::here("03_dados", "vetor", paste0("SP_3543907_RIOS_SIMPLES", i)), mode = "wb")
}
```

### Download de **pol√≠gonos de cobertura da terra** para Rio Claro/SP

```r
# download polygon
for(i in c(".dbf", ".prj", ".shp", ".shx")){
  download.file(url = paste0("http://geo.fbds.org.br/SP/RIO_CLARO/USO/SP_3543907_USO", i),
                destfile = here::here("03_dados", "vetor", paste0("SP_3543907_USO", i)), mode = "wb")
}
```

---

# 4. Importar dados vetoriais

## Dados preexistentes


```r
# importar pontos
rc_nas &lt;- sf::st_read(here::here("03_dados", "vetor", "SP_3543907_NASCENTES.shp"), quiet = TRUE)
rc_nas
```

```
## Simple feature collection with 1220 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 217622.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##    GEOCODIGO MUNICIPIO UF CD_UF    HIDRO                 geometry
## 1    3543907 RIO CLARO SP    35 nascente POINT (217622.9 7528315)
## 2    3543907 RIO CLARO SP    35 nascente POINT (217836.5 7528103)
## 3    3543907 RIO CLARO SP    35 nascente POINT (217988.9 7528203)
## 4    3543907 RIO CLARO SP    35 nascente POINT (218288.9 7528237)
## 5    3543907 RIO CLARO SP    35 nascente POINT (218346.6 7530583)
## 6    3543907 RIO CLARO SP    35 nascente POINT (218393.1 7528031)
## 7    3543907 RIO CLARO SP    35 nascente POINT (218508.3 7528470)
## 8    3543907 RIO CLARO SP    35 nascente POINT (218535.4 7530642)
## 9    3543907 RIO CLARO SP    35 nascente POINT (218583.5 7528215)
## 10   3543907 RIO CLARO SP    35 nascente POINT (218760.1 7530258)
```

---

# 4. Importar dados vetoriais

## Dados preexistentes


```r
# plot
plot(rc_nas$geometry, pch = 20, col = "blue", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-34-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados preexistentes


```r
# importar linhas
rc_hid &lt;- sf::st_read(here::here("03_dados", "vetor", "SP_3543907_RIOS_SIMPLES.shp"), quiet = TRUE)
rc_hid
```

```
## Simple feature collection with 1 feature and 6 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: 215155.3 ymin: 7504132 xmax: 246367.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF                  HIDRO COMP_KM                       geometry
## 1   3543907 RIO CLARO SP    35 curso d'√°gua (0 - 10m) 1142.98 MULTILINESTRING ((231815.7 ...
```

---

# 4. Importar dados vetoriais

## Dados preexistentes


```r
# plot
plot(rc_hid$geometry, col = "steelblue", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-36-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados preexistentes


```r
# importar poligonos
rc_cob &lt;- sf::st_read(here::here("03_dados", "vetor", "SP_3543907_USO.shp"), quiet = TRUE)
rc_cob
```

```
## Simple feature collection with 5 features and 6 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 215151.7 ymin: 7503723 xmax: 246582.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA                       geometry
## 1   3543907 RIO CLARO SP    35               √°gua   357.027 MULTIPOLYGON (((235487.6 75...
## 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800 MULTIPOLYGON (((232275 7504...
## 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330 MULTIPOLYGON (((233123.6 75...
## 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990 MULTIPOLYGON (((232355 7504...
## 5   3543907 RIO CLARO SP    35       silvicultura   138.173 MULTIPOLYGON (((243052.1 75...
```

---

# 4. Importar dados vetoriais

## Dados preexistentes


```r
# plot
plot(rc_cob[5], col = c("blue", "orange", "gray30", "forestgreen", "green"), main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-38-1.png" width="35%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de GPS (.gpx)


```r
# importar dados de gps
gps_gpx &lt;- sf::st_read(here::here("03_dados", "vetor", "waypoints.gpx"), layer = "waypoints", quiet = TRUE)
gps_gpx
```

```
## Simple feature collection with 11 features and 23 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -47.54245 ymin: -22.39524 xmax: -47.53969 ymax: -22.39209
## Geodetic CRS:  WGS 84
## First 10 features:
##         ele                time magvar geoidheight name cmt desc  src link1_href link1_text link1_type link2_href link2_text link2_type
## 1  603.0454 2020-08-20 10:13:35     NA          NA  102  33 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 2  595.2947 2020-08-20 10:22:52     NA          NA  103  71 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 3  581.9885 2020-08-20 10:32:30     NA          NA  104  11 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 4  587.4568 2020-08-20 10:42:05     NA          NA  105  72 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 5  581.2265 2020-08-20 10:49:32     NA          NA  106  68 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 6  593.6844 2020-08-20 11:06:53     NA          NA  107 121 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 7  591.4097 2020-08-20 11:16:36     NA          NA  108  83 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 8  594.1143 2020-08-20 11:27:59     NA          NA  109 162 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 9  594.4582 2020-08-20 11:43:04     NA          NA  110 103 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
## 10 602.0156 2020-08-20 11:58:32     NA          NA  111  52 &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;
##            sym type  fix sat hdop vdop pdop ageofdgpsdata dgpsid                    geometry
## 1  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA  POINT (-47.5405 -22.39524)
## 2  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA  POINT (-47.5398 -22.39511)
## 3  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.53969 -22.39424)
## 4  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.54019 -22.39424)
## 5  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.53973 -22.39353)
## 6  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.54073 -22.39395)
## 7  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.54059 -22.39284)
## 8  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.54166 -22.39209)
## 9  Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.54161 -22.39258)
## 10 Scenic Area &lt;NA&gt; &lt;NA&gt;  NA   NA   NA   NA            NA     NA POINT (-47.54245 -22.39246)
```

---

# 4. Importar dados vetoriais

## Dados de GPS (.gpx)


```r
# plot
plot(gps_gpx$geometry, cex = 4, pch = 20, col = "red", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-40-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de GPS (.kml)


```r
# importar dados de gps
gps_kml &lt;- sf::st_read(here::here("03_dados", "vetor", "waypoints.kml"), quiet = TRUE)
gps_kml
```

```
## Simple feature collection with 11 features and 16 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -47.54245 ymin: -22.39524 xmax: -47.53969 ymax: -22.39209
## Geodetic CRS:  WGS 84
## First 10 features:
##    Name description timestamp begin  end altitudeMode tessellate extrude visibility drawOrder icon elevation comment source  url url.name
## 1   102        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  603.0454      33   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 2   103        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  595.2947      71   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 3   104        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  581.9885      11   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 4   105        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  587.4568      72   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 5   106        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  581.2265      68   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 6   107        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  593.6844     121   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 7   108        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  591.4097      83   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 8   109        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  594.1143     162   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 9   110        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  594.4582     103   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
## 10  111        &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;         &lt;NA&gt;         -1       0         -1        NA &lt;NA&gt;  602.0156      52   &lt;NA&gt; &lt;NA&gt;     &lt;NA&gt;
##                       geometry
## 1   POINT (-47.5405 -22.39524)
## 2   POINT (-47.5398 -22.39511)
## 3  POINT (-47.53969 -22.39424)
## 4  POINT (-47.54019 -22.39424)
## 5  POINT (-47.53973 -22.39353)
## 6  POINT (-47.54073 -22.39395)
## 7  POINT (-47.54059 -22.39284)
## 8  POINT (-47.54166 -22.39209)
## 9  POINT (-47.54161 -22.39258)
## 10 POINT (-47.54245 -22.39246)
```

---

# 4. Importar dados vetoriais

## Dados de GPS (.kml)


```r
# plot
plot(gps_kml$geometry, cex = 4, pch = 20, col = "blue", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-42-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de uma tabela de coordenadas


```r
# importar tabela
si &lt;- readr::read_csv(
  here::here("03_dados", "tabelas", "ATLANTIC_AMPHIBIANS_sites.csv"))
si
```

```
## [90m# A tibble: 1,163 √ó 25[39m
##    id      reference_number species_number record sampled_habitat active_methods passive_methods complementary_me‚Ä¶ period  month_start year_start
##    [3m[90m&lt;chr&gt;[39m[23m              [3m[90m&lt;dbl&gt;[39m[23m          [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;chr&gt;[39m[23m          [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;chr&gt;[39m[23m             [3m[90m&lt;chr&gt;[39m[23m         [3m[90m&lt;dbl&gt;[39m[23m      [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m amp1001             [4m1[24m001             19 ab     fo,ll           as             pt              [31mNA[39m                mo,da,‚Ä¶           9       [4m2[24m000
## [90m 2[39m amp1002             [4m1[24m002             16 co     fo,la,ll        as             pt              [31mNA[39m                mo,da,‚Ä¶          12       [4m2[24m007
## [90m 3[39m amp1003             [4m1[24m002             14 co     fo,la,ll        as             pt              [31mNA[39m                mo,da,‚Ä¶          12       [4m2[24m007
## [90m 4[39m amp1004             [4m1[24m002             13 co     fo,la,ll        as             pt              [31mNA[39m                mo,da,‚Ä¶          12       [4m2[24m007
## [90m 5[39m amp1005             [4m1[24m003             30 co     fo,ll,br        as             [31mNA[39m              [31mNA[39m                mo,da,‚Ä¶           7       [4m1[24m988
## [90m 6[39m amp1006             [4m1[24m004             42 co     tp,pp,la,ll,is  [31mNA[39m             [31mNA[39m              [31mNA[39m                [31mNA[39m               [31mNA[39m         [31mNA[39m
## [90m 7[39m amp1007             [4m1[24m005             23 co     sp              as             [31mNA[39m              [31mNA[39m                [31mNA[39m                4       [4m2[24m007
## [90m 8[39m amp1008             [4m1[24m005             19 co     sp,la,sw        as,sb,tr       [31mNA[39m              [31mNA[39m                tw,ni             4       [4m2[24m007
## [90m 9[39m amp1009             [4m1[24m005             13 ab     fo              [31mNA[39m             pt              [31mNA[39m                mo,da,‚Ä¶           4       [4m2[24m007
## [90m10[39m amp1010             [4m1[24m006              1 ab     fo              [31mNA[39m             pt              [31mNA[39m                mo,da,‚Ä¶           5       [4m2[24m011
## [90m# ‚Ä¶ with 1,153 more rows, and 14 more variables: month_finish &lt;dbl&gt;, year_finish &lt;dbl&gt;, effort_months &lt;dbl&gt;, country &lt;chr&gt;, state &lt;chr&gt;,[39m
## [90m#   state_abbreviation &lt;chr&gt;, municipality &lt;chr&gt;, site &lt;chr&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, coordinate_precision &lt;chr&gt;, altitude &lt;dbl&gt;,[39m
## [90m#   temperature &lt;dbl&gt;, precipitation &lt;dbl&gt;[39m
```

---

# 4. Importar dados vetoriais

## Dados de uma tabela de coordenadas (.csv | .xlsx)


```r
# converter para sf
si_ve &lt;- si %&gt;% 
  sf::st_as_sf(coords = c("longitude", "latitude"), crs = 4326)
si_ve
```

```
## Simple feature collection with 1163 features and 23 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -56.74194 ymin: -33.51083 xmax: -34.79667 ymax: -3.51525
## Geodetic CRS:  WGS 84
## [90m# A tibble: 1,163 √ó 24[39m
##    id      reference_number species_number record sampled_habitat active_methods passive_methods complementary_me‚Ä¶ period  month_start year_start
##  [90m*[39m [3m[90m&lt;chr&gt;[39m[23m              [3m[90m&lt;dbl&gt;[39m[23m          [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;chr&gt;[39m[23m          [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;chr&gt;[39m[23m             [3m[90m&lt;chr&gt;[39m[23m         [3m[90m&lt;dbl&gt;[39m[23m      [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m amp1001             [4m1[24m001             19 ab     fo,ll           as             pt              [31mNA[39m                mo,da,‚Ä¶           9       [4m2[24m000
## [90m 2[39m amp1002             [4m1[24m002             16 co     fo,la,ll        as             pt              [31mNA[39m                mo,da,‚Ä¶          12       [4m2[24m007
## [90m 3[39m amp1003             [4m1[24m002             14 co     fo,la,ll        as             pt              [31mNA[39m                mo,da,‚Ä¶          12       [4m2[24m007
## [90m 4[39m amp1004             [4m1[24m002             13 co     fo,la,ll        as             pt              [31mNA[39m                mo,da,‚Ä¶          12       [4m2[24m007
## [90m 5[39m amp1005             [4m1[24m003             30 co     fo,ll,br        as             [31mNA[39m              [31mNA[39m                mo,da,‚Ä¶           7       [4m1[24m988
## [90m 6[39m amp1006             [4m1[24m004             42 co     tp,pp,la,ll,is  [31mNA[39m             [31mNA[39m              [31mNA[39m                [31mNA[39m               [31mNA[39m         [31mNA[39m
## [90m 7[39m amp1007             [4m1[24m005             23 co     sp              as             [31mNA[39m              [31mNA[39m                [31mNA[39m                4       [4m2[24m007
## [90m 8[39m amp1008             [4m1[24m005             19 co     sp,la,sw        as,sb,tr       [31mNA[39m              [31mNA[39m                tw,ni             4       [4m2[24m007
## [90m 9[39m amp1009             [4m1[24m005             13 ab     fo              [31mNA[39m             pt              [31mNA[39m                mo,da,‚Ä¶           4       [4m2[24m007
## [90m10[39m amp1010             [4m1[24m006              1 ab     fo              [31mNA[39m             pt              [31mNA[39m                mo,da,‚Ä¶           5       [4m2[24m011
## [90m# ‚Ä¶ with 1,153 more rows, and 13 more variables: month_finish &lt;dbl&gt;, year_finish &lt;dbl&gt;, effort_months &lt;dbl&gt;, country &lt;chr&gt;, state &lt;chr&gt;,[39m
## [90m#   state_abbreviation &lt;chr&gt;, municipality &lt;chr&gt;, site &lt;chr&gt;, coordinate_precision &lt;chr&gt;, altitude &lt;dbl&gt;, temperature &lt;dbl&gt;,[39m
## [90m#   precipitation &lt;dbl&gt;, geometry &lt;POINT [¬∞]&gt;[39m
```

---

# 4. Importar dados vetoriais

## Dados de uma tabela de coordenadas (.csv | .xlsx)


```r
# plot
plot(si_ve$geometry, pch = 20, main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-45-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/package_geobr.png)
background-size: 300px
background-position: 50% 70%

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
install.packages("geobr")
library(geobr)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[geobr](https://github.com/ipeaGIT/geobr)

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# brasil 2019
br_2019 &lt;- geobr::read_country(year = 2019, showProgress = FALSE)
br_2019
```

```
## Simple feature collection with 27 features and 5 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -73.99045 ymin: -33.75118 xmax: -28.84784 ymax: 5.271841
## Geodetic CRS:  SIRGAS 2000
## First 10 features:
##    code_state abbrev_state name_state code_region name_region                           geom
## 1          11           RO   Rond√¥nia           1       Norte MULTIPOLYGON (((-65.3815 -1...
## 2          12           AC       Acre           1       Norte MULTIPOLYGON (((-71.07772 -...
## 3          13           AM   Amaz√¥nas           1       Norte MULTIPOLYGON (((-69.83766 -...
## 4          14           RR    Roraima           1       Norte MULTIPOLYGON (((-63.96008 2...
## 5          15           PA       Par√°           1       Norte MULTIPOLYGON (((-51.43248 -...
## 6          16           AP      Amap√°           1       Norte MULTIPOLYGON (((-53.27918 2...
## 7          17           TO  Tocantins           1       Norte MULTIPOLYGON (((-48.23163 -...
## 8          21           MA   Maranh√£o           2    Nordeste MULTIPOLYGON (((-46.16128 -...
## 9          22           PI      Piau√≠           2    Nordeste MULTIPOLYGON (((-42.91539 -...
## 10         23           CE      Cear√°           2    Nordeste MULTIPOLYGON (((-41.18292 -...
```

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# plot
plot(br_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-48-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*

```r
# brasil 1872
br_1872 &lt;- geobr::read_country(year = 1872, showProgress = FALSE)
br_1872
```

```
## Simple feature collection with 1 feature and 0 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -73.80132 ymin: -33.74912 xmax: -34.79313 ymax: 5.271891
## Geodetic CRS:  SIRGAS 2000
##                             geom
## 1 MULTIPOLYGON (((-48.40975 -...
```

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# plot
plot(br_1872$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-50-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# sao paulo municipios
sp_mun_2019 &lt;- geobr::read_municipality(code_muni = "SP", year = 2019, showProgress = FALSE)
sp_mun_2019
```

```
## Simple feature collection with 645 features and 7 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -53.10986 ymin: -25.35794 xmax: -44.16137 ymax: -19.77966
## Geodetic CRS:  SIRGAS 2000
## First 10 features:
##    code_muni              name_muni code_state abbrev_state name_state code_region name_region                           geom
## 1    3500105             Adamantina         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-51.17919 -...
## 2    3500204                 Adolfo         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-49.61249 -...
## 3    3500303                  Agua√≠         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-47.21948 -...
## 4    3500402         √Åguas Da Prata         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-46.73076 -...
## 5    3500501       √Åguas De Lind√≥ia         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-46.66057 -...
## 6    3500550 √Åguas De Santa B√°rbara         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-49.30905 -...
## 7    3500600     √Åguas De S√£o Pedro         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-47.87649 -...
## 8    3500709                 Agudos         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-49.06121 -...
## 9    3500758               Alambari         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-47.95571 -...
## 10   3500808      Alfredo Marcondes         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-51.46862 -...
```

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# plot
plot(sp_mun_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-52-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# rio claro
rc_2020 &lt;- geobr::read_municipality(code_muni = 3543907, year = 2020, showProgress = FALSE)
rc_2020
```

```
## Simple feature collection with 1 feature and 7 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -47.76521 ymin: -22.55203 xmax: -47.46188 ymax: -22.24368
## Geodetic CRS:  SIRGAS 2000
##     code_muni name_muni code_state abbrev_state name_state code_region name_region                           geom
## 493   3543907 Rio Claro         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-47.46875 -...
```

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# plot
plot(rc_2020$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-54-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# biomas
bi_2019 &lt;- geobr::read_biomes(year = 2019, showProgress = FALSE)
bi_2019
```

```
## Simple feature collection with 7 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -73.98304 ymin: -34.95942 xmax: -28.84785 ymax: 7.053767
## Geodetic CRS:  SIRGAS 2000
##         name_biome code_biome year                           geom
## 1         Amaz√¥nia          1 2019 MULTIPOLYGON (((-44.08515 -...
## 2         Caatinga          2 2019 MULTIPOLYGON (((-41.7408 -2...
## 3          Cerrado          3 2019 MULTIPOLYGON (((-43.39009 -...
## 4   Mata Atl√¢ntica          4 2019 MULTIPOLYGON (((-48.70814 -...
## 5            Pampa          5 2019 MULTIPOLYGON (((-52.82472 -...
## 6         Pantanal          6 2019 MULTIPOLYGON (((-57.75946 -...
## 7 Sistema Costeiro         NA 2019 MULTIPOLYGON (((-44.64799 -...
```

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# plot
plot(bi_2019$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-56-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*

&lt;br&gt;

|Function|Geographies available|Years available|Source|
|-----|-----|-----|-----|
|`read_country()`| Country | 1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019 | IBGE |
|`read_state()`| States | 1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019 | IBGE |
|`read_municipality()`| Municipality | 1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991, 2000, 2001, 2005, 2007, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019 | IBGE | 
|`read_biomes()`| Biomes | 2004, 2019 | IBGE | 

---

# 4. Importar dados vetoriais

## Dados de pacotes: *geobr*


```r
# list all datasets available in the geobr package
geobr::list_geobr()
```

```
## [90m# A tibble: 27 √ó 4[39m
##    `function`                 geography                                  years                                                             source
##    [3m[90m&lt;chr&gt;[39m[23m                      [3m[90m&lt;chr&gt;[39m[23m                                      [3m[90m&lt;chr&gt;[39m[23m                                                             [3m[90m&lt;chr&gt;[39m[23m 
## [90m 1[39m `read_country`             Country                                    1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991‚Ä¶ IBGE  
## [90m 2[39m `read_region`              Region                                     2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020  IBGE  
## [90m 3[39m `read_state`               States                                     1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991‚Ä¶ IBGE  
## [90m 4[39m `read_meso_region`         Meso region                                2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020  IBGE  
## [90m 5[39m `read_micro_region`        Micro region                               2000, 2001, 2010, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020  IBGE  
## [90m 6[39m `read_intermediate_region` Intermediate region                        2017, 2019, 2020                                                  IBGE  
## [90m 7[39m `read_immediate_region`    Immediate region                           2017, 2019, 2020                                                  IBGE  
## [90m 8[39m `read_municipality`        Municipality                               1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991‚Ä¶ IBGE  
## [90m 9[39m `read_municipal_seat`      Municipality seats (sedes municipais)      1872, 1900, 1911, 1920, 1933, 1940, 1950, 1960, 1970, 1980, 1991‚Ä¶ IBGE  
## [90m10[39m `read_weighting_area`      Census weighting area (√°rea de pondera√ß√£o) 2010                                                              IBGE  
## [90m# ‚Ä¶ with 17 more rows[39m
```

---

background-image: url(img/package_ropensci.png)
background-size: 500px
background-position: 50% 70%

# 4. Importar dados vetoriais

## Dados de pacotes: *rnaturalearth*


```r
# package
install.packages("rnaturalearth")
library(rnaturalearth)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[naturalearthdata](http://www.naturalearthdata.com/),
[rnaturalearth](https://docs.ropensci.org/rnaturalearth/)

---

# 4. Importar dados vetoriais

## Dados de pacotes: *rnaturalearth*


```r
# south america
sa &lt;- rnaturalearth::ne_countries(scale = "small", continent = "South America", returnclass = "sf")
sa
```

```
## Simple feature collection with 13 features and 63 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -81.41094 ymin: -55.61183 xmax: -34.72999 ymax: 12.4373
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## First 10 features:
##     scalerank      featurecla labelrank     sovereignt sov_a3 adm0_dif level              type            admin adm0_a3 geou_dif
## 4           1 Admin-0 country         2      Argentina    ARG        0     2 Sovereign country        Argentina     ARG        0
## 21          1 Admin-0 country         3        Bolivia    BOL        0     2 Sovereign country          Bolivia     BOL        0
## 22          1 Admin-0 country         2         Brazil    BRA        0     2 Sovereign country           Brazil     BRA        0
## 29          1 Admin-0 country         2          Chile    CHL        0     2 Sovereign country            Chile     CHL        0
## 35          1 Admin-0 country         2       Colombia    COL        0     2 Sovereign country         Colombia     COL        0
## 46          1 Admin-0 country         3        Ecuador    ECU        0     2 Sovereign country          Ecuador     ECU        0
## 54          1 Admin-0 country         5 United Kingdom    GB1        1     2        Dependency Falkland Islands     FLK        0
## 67          1 Admin-0 country         4         Guyana    GUY        0     2 Sovereign country           Guyana     GUY        0
## 124         1 Admin-0 country         2           Peru    PER        0     2 Sovereign country             Peru     PER        0
## 131         1 Admin-0 country         4       Paraguay    PRY        0     2 Sovereign country         Paraguay     PRY        0
##              geounit gu_a3 su_dif          subunit su_a3 brk_diff         name        name_long brk_a3     brk_name brk_group   abbrev postal
## 4          Argentina   ARG      0        Argentina   ARG        0    Argentina        Argentina    ARG    Argentina      &lt;NA&gt;     Arg.     AR
## 21           Bolivia   BOL      0          Bolivia   BOL        0      Bolivia          Bolivia    BOL      Bolivia      &lt;NA&gt;  Bolivia     BO
## 22            Brazil   BRA      0           Brazil   BRA        0       Brazil           Brazil    BRA       Brazil      &lt;NA&gt;   Brazil     BR
## 29             Chile   CHL      0            Chile   CHL        0        Chile            Chile    CHL        Chile      &lt;NA&gt;    Chile     CL
## 35          Colombia   COL      0         Colombia   COL        0     Colombia         Colombia    COL     Colombia      &lt;NA&gt;     Col.     CO
## 46           Ecuador   ECU      0          Ecuador   ECU        0      Ecuador          Ecuador    ECU      Ecuador      &lt;NA&gt;     Ecu.     EC
## 54  Falkland Islands   FLK      0 Falkland Islands   FLK        1 Falkland Is. Falkland Islands    B12 Falkland Is.      &lt;NA&gt; Flk. Is.     FK
## 67            Guyana   GUY      0           Guyana   GUY        0       Guyana           Guyana    GUY       Guyana      &lt;NA&gt;     Guy.     GY
## 124             Peru   PER      0             Peru   PER        0         Peru             Peru    PER         Peru      &lt;NA&gt;     Peru     PE
## 131         Paraguay   PRY      0         Paraguay   PRY        0     Paraguay         Paraguay    PRY     Paraguay      &lt;NA&gt;    Para.     PY
##                           formal_en formal_fr note_adm0                             note_brk        name_sort       name_alt mapcolor7 mapcolor8
## 4                Argentine Republic      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;        Argentina           &lt;NA&gt;         3         1
## 21   Plurinational State of Bolivia      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;          Bolivia           &lt;NA&gt;         1         5
## 22    Federative Republic of Brazil      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;           Brazil           &lt;NA&gt;         5         6
## 29                Republic of Chile      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;            Chile           &lt;NA&gt;         5         1
## 35             Republic of Colombia      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;         Colombia           &lt;NA&gt;         2         1
## 46              Republic of Ecuador      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;          Ecuador           &lt;NA&gt;         1         5
## 54                 Falkland Islands      &lt;NA&gt;      U.K. Admin. by U.K.; Claimed by Argentina Falkland Islands Islas Malvinas         6         6
## 67  Co-operative Republic of Guyana      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;           Guyana           &lt;NA&gt;         3         1
## 124                Republic of Peru      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;             Peru           &lt;NA&gt;         4         4
## 131            Republic of Paraguay      &lt;NA&gt;      &lt;NA&gt;                                 &lt;NA&gt;         Paraguay           &lt;NA&gt;         6         3
##     mapcolor9 mapcolor13   pop_est gdp_md_est pop_year lastcensus gdp_year                    economy             income_grp wikipedia fips_10
## 4           3         13  40913584   573900.0       NA       2010       NA    5. Emerging region: G20 3. Upper middle income        NA    &lt;NA&gt;
## 21          2          3   9775246    43270.0       NA       2001       NA    5. Emerging region: G20 4. Lower middle income        NA    &lt;NA&gt;
## 22          5          7 198739269  1993000.0       NA       2010       NA   3. Emerging region: BRIC 3. Upper middle income        NA    &lt;NA&gt;
## 29          5          9  16601707   244500.0       NA       2002       NA    5. Emerging region: G20 3. Upper middle income        NA    &lt;NA&gt;
## 35          3          1  45644023   395400.0       NA       2006       NA       6. Developing region 3. Upper middle income        NA    &lt;NA&gt;
## 46          2         12  14573101   107700.0       NA       2010       NA       6. Developing region 3. Upper middle income        NA    &lt;NA&gt;
## 54          6          3      3140      105.1       NA         NA       NA 2. Developed region: nonG7   1. High income: OECD        NA    &lt;NA&gt;
## 67          4          8    772298     2966.0       NA       2002       NA       6. Developing region 4. Lower middle income        NA    &lt;NA&gt;
## 124         4         11  29546963   247300.0       NA       2007       NA    5. Emerging region: G20 3. Upper middle income        NA    &lt;NA&gt;
## 131         6          2   6995655    28890.0       NA       2002       NA    5. Emerging region: G20 4. Lower middle income        NA    &lt;NA&gt;
##     iso_a2 iso_a3 iso_n3 un_a3 wb_a2 wb_a3 woe_id adm0_a3_is adm0_a3_us adm0_a3_un adm0_a3_wb     continent region_un     subregion
## 4       AR    ARG    032   032    AR   ARG     NA        ARG        ARG         NA         NA South America  Americas South America
## 21      BO    BOL    068   068    BO   BOL     NA        BOL        BOL         NA         NA South America  Americas South America
## 22      BR    BRA    076   076    BR   BRA     NA        BRA        BRA         NA         NA South America  Americas South America
## 29      CL    CHL    152   152    CL   CHL     NA        CHL        CHL         NA         NA South America  Americas South America
## 35      CO    COL    170   170    CO   COL     NA        COL        COL         NA         NA South America  Americas South America
## 46      EC    ECU    218   218    EC   ECU     NA        ECU        ECU         NA         NA South America  Americas South America
## 54      FK    FLK    238   238  &lt;NA&gt;  &lt;NA&gt;     NA        FLK        FLK         NA         NA South America  Americas South America
## 67      GY    GUY    328   328    GY   GUY     NA        GUY        GUY         NA         NA South America  Americas South America
## 124     PE    PER    604   604    PE   PER     NA        PER        PER         NA         NA South America  Americas South America
## 131     PY    PRY    600   600    PY   PRY     NA        PRY        PRY         NA         NA South America  Americas South America
##                     region_wb name_len long_len abbrev_len tiny homepart                       geometry
## 4   Latin America &amp; Caribbean        9        9          4   NA        1 MULTIPOLYGON (((-65.5 -55.2...
## 21  Latin America &amp; Caribbean        7        7          7   NA        1 MULTIPOLYGON (((-62.84647 -...
## 22  Latin America &amp; Caribbean        6        6          6   NA        1 MULTIPOLYGON (((-57.62513 -...
## 29  Latin America &amp; Caribbean        5        5          5   NA        1 MULTIPOLYGON (((-68.63401 -...
## 35  Latin America &amp; Caribbean        8        8          4   NA        1 MULTIPOLYGON (((-75.37322 -...
## 46  Latin America &amp; Caribbean        7        7          4   NA        1 MULTIPOLYGON (((-80.30256 -...
## 54  Latin America &amp; Caribbean       12       16          8   NA       NA MULTIPOLYGON (((-61.2 -51.8...
## 67  Latin America &amp; Caribbean        6        6          4   NA        1 MULTIPOLYGON (((-59.75828 8...
## 124 Latin America &amp; Caribbean        4        4          4   NA        1 MULTIPOLYGON (((-69.59042 -...
## 131 Latin America &amp; Caribbean        8        8          5   NA        1 MULTIPOLYGON (((-62.68506 -...
```

---

# 4. Importar dados vetoriais

## Dados de pacotes: *rnaturalearth*


```r
# plot
plot(sa$geometry, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-60-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 5. Descri√ß√£o de objetos sf

## Informa√ß√µes geogr√°ficas e tabela de atributos


```r
# rio claro
rc_2020
```

```
## Simple feature collection with 1 feature and 7 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -47.76521 ymin: -22.55203 xmax: -47.46188 ymax: -22.24368
## Geodetic CRS:  SIRGAS 2000
##     code_muni name_muni code_state abbrev_state name_state code_region name_region                           geom
## 493   3543907 Rio Claro         35           SP  S√£o Paulo           3     Sudeste MULTIPOLYGON (((-47.46875 -...
```

---

background-image: url(img/geo_sf_xfig.png)
background-size: 700px
background-position: 50% 90%

# 5. Descri√ß√£o de objetos sf

## Informa√ß√µes

- *resumo do vetor*: indica o n√∫mero de fei√ß√µes (linhas) e campos (colunas)
- *tipo da geometria*: umas das sete classes listadas anteriormente
- *dimens√£o*: n√∫mero de dimens√µes, geralmente duas (XY)
- *bbox (bordas)*: coordenadas m√≠nimas e m√°ximas da longitude e latitude
- *informa√ß√£o do CRS*: `epsg` ou `proj4string` indicando o CRS
- *tibble*: tabela de atributos, com destaque para a coluna `geom` ou `geometry` que representa cada fei√ß√£o ou geometria

---

# 5. Descri√ß√£o de objetos sf

## Informa√ß√µes geogr√°ficas

### Geometry type


```r
# tipo de geometria
sf::st_geometry_type(rc_2020)
```

```
## [1] MULTIPOLYGON
## 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT MULTILINESTRING MULTIPOLYGON GEOMETRYCOLLECTION CIRCULARSTRING ... TRIANGLE
```

--

### Bounding box


```r
# extensao
sf::st_bbox(rc_2020)
```

```
##      xmin      ymin      xmax      ymax 
## -47.76521 -22.55203 -47.46188 -22.24368
```

---

# 5. Descri√ß√£o de objetos sf

## Informa√ß√µes geogr√°ficas

### Coordinate Reference System (CRS)


```r
# crs
sf::st_crs(rc_2020)
```

```
## Coordinate Reference System:
##   User input: SIRGAS 2000 
##   wkt:
## GEOGCRS["SIRGAS 2000",
##     DATUM["Sistema de Referencia Geocentrico para las AmericaS 2000",
##         ELLIPSOID["GRS 1980",6378137,298.257222101,
##             LENGTHUNIT["metre",1]]],
##     PRIMEM["Greenwich",0,
##         ANGLEUNIT["degree",0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS["geodetic latitude (Lat)",north,
##             ORDER[1],
##             ANGLEUNIT["degree",0.0174532925199433]],
##         AXIS["geodetic longitude (Lon)",east,
##             ORDER[2],
##             ANGLEUNIT["degree",0.0174532925199433]],
##     USAGE[
##         SCOPE["Horizontal component of 3D system."],
##         AREA["Latin America - Central America and South America - onshore and offshore. Brazil - onshore and offshore."],
##         BBOX[-59.87,-122.19,32.72,-25.28]],
##     ID["EPSG",4674]]
```

---

background-image: url(img/geo_vector_attribute_table.png)
background-size: 450px
background-position: 45% 80%

# 5. Descri√ß√£o de objetos sf

## Tabela de atributos

### Rela√ß√£o entre a geometria e suas caracter√≠sticas

---

# 5. Descri√ß√£o de objetos sf

## Tabela de atributos

### Acessar a tabela de atributos de um `sf`


```r
# acessar a tabela de atributos
rc_2020_tab &lt;- sf::st_drop_geometry(rc_2020)
rc_2020_tab
```

```
##     code_muni name_muni code_state abbrev_state name_state code_region name_region
## 493   3543907 Rio Claro         35           SP  S√£o Paulo           3     Sudeste
```


```r
# classe
class(rc_2020_tab)
```

```
## [1] "data.frame"
```

---

background-image: url(img/geo_sp.png),url(img/geo_sp_dep.png)
background-size: 250px, 700px
background-position: 20% 90%, 93% 50%

# 6. Converter objetos para sf

## Tipos de objetos `sp`

- SpatialPoints 
- SpatialLines
- SpatialPolygons
- SpatialPointsdata frame
- SpatialLinesdata frame
- SpatialPolygonsdata frame

---

# 6. Converter objetos para sf

## Dados `sp`


```r
# paises sp
co110_sp &lt;- rnaturalearth::countries110
co110_sp
```

```
## class       : SpatialPolygonsDataFrame 
## features    : 177 
## extent      : -180, 180, -90, 83.64513  (xmin, xmax, ymin, ymax)
## crs         : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
## variables   : 63
## names       : scalerank,      featurecla, labelrank,  sovereignt, sov_a3, adm0_dif, level,              type,       admin, adm0_a3, geou_dif,     geounit, gu_a3, su_dif,     subunit, ... 
## min values  :         1, Admin-0 country,         2, Afghanistan,    AFG,        0,     2,           Country, Afghanistan,     AFG,        0, Afghanistan,   AFG,      0, Afghanistan, ... 
## max values  :         3, Admin-0 country,         7,    Zimbabwe,    ZWE,        1,     2, Sovereign country,    Zimbabwe,     ZWE,        0,    Zimbabwe,   ZWE,      1,    Zimbabwe, ...
```

---

# 6. Converter objetos para sf

## Converter `sp` para `sf`


```r
# paises sf
co110_sf &lt;- sf::st_as_sf(co110_sp)
co110_sf
```

```
## Simple feature collection with 177 features and 63 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 83.64513
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## First 10 features:
##   scalerank      featurecla labelrank           sovereignt sov_a3 adm0_dif level              type                               admin adm0_a3
## 0         1 Admin-0 country         3          Afghanistan    AFG        0     2 Sovereign country                         Afghanistan     AFG
## 1         1 Admin-0 country         3               Angola    AGO        0     2 Sovereign country                              Angola     AGO
## 2         1 Admin-0 country         6              Albania    ALB        0     2 Sovereign country                             Albania     ALB
## 3         1 Admin-0 country         4 United Arab Emirates    ARE        0     2 Sovereign country                United Arab Emirates     ARE
## 4         1 Admin-0 country         2            Argentina    ARG        0     2 Sovereign country                           Argentina     ARG
## 5         1 Admin-0 country         6              Armenia    ARM        0     2 Sovereign country                             Armenia     ARM
## 6         1 Admin-0 country         4           Antarctica    ATA        0     2     Indeterminate                          Antarctica     ATA
## 7         3 Admin-0 country         6               France    FR1        1     2        Dependency French Southern and Antarctic Lands     ATF
## 8         1 Admin-0 country         2            Australia    AU1        1     2           Country                           Australia     AUS
## 9         1 Admin-0 country         4              Austria    AUT        0     2 Sovereign country                             Austria     AUT
##   geou_dif                             geounit gu_a3 su_dif                             subunit su_a3 brk_diff                   name
## 0        0                         Afghanistan   AFG      0                         Afghanistan   AFG        0            Afghanistan
## 1        0                              Angola   AGO      0                              Angola   AGO        0                 Angola
## 2        0                             Albania   ALB      0                             Albania   ALB        0                Albania
## 3        0                United Arab Emirates   ARE      0                United Arab Emirates   ARE        0   United Arab Emirates
## 4        0                           Argentina   ARG      0                           Argentina   ARG        0              Argentina
## 5        0                             Armenia   ARM      0                             Armenia   ARM        0                Armenia
## 6        0                          Antarctica   ATA      0                          Antarctica   ATA        0             Antarctica
## 7        0 French Southern and Antarctic Lands   ATF      0 French Southern and Antarctic Lands   ATF        0 Fr. S. Antarctic Lands
## 8        0                           Australia   AUS      0                           Australia   AUS        0              Australia
## 9        0                             Austria   AUT      0                             Austria   AUT        0                Austria
##                             name_long brk_a3                   brk_name brk_group     abbrev postal
## 0                         Afghanistan    AFG                Afghanistan      &lt;NA&gt;       Afg.     AF
## 1                              Angola    AGO                     Angola      &lt;NA&gt;       Ang.     AO
## 2                             Albania    ALB                    Albania      &lt;NA&gt;       Alb.     AL
## 3                United Arab Emirates    ARE       United Arab Emirates      &lt;NA&gt;     U.A.E.     AE
## 4                           Argentina    ARG                  Argentina      &lt;NA&gt;       Arg.     AR
## 5                             Armenia    ARM                    Armenia      &lt;NA&gt;       Arm.    ARM
## 6                          Antarctica    ATA                 Antarctica      &lt;NA&gt;       Ant.     AQ
## 7 French Southern and Antarctic Lands    ATF Fr. S. and Antarctic Lands      &lt;NA&gt; Fr. S.A.L.     TF
## 8                           Australia    AUS                  Australia      &lt;NA&gt;       Auz.     AU
## 9                             Austria    AUT                    Austria      &lt;NA&gt;      Aust.      A
##                                              formal_en formal_fr note_adm0                         note_brk                           name_sort
## 0                         Islamic State of Afghanistan      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                         Afghanistan
## 1                          People's Republic of Angola      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                              Angola
## 2                                  Republic of Albania      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                             Albania
## 3                                 United Arab Emirates      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                United Arab Emirates
## 4                                   Argentine Republic      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                           Argentina
## 5                                  Republic of Armenia      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                             Armenia
## 6                                                 &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt; Multiple claims held in abeyance                          Antarctica
## 7 Territory of the French Southern and Antarctic Lands      &lt;NA&gt;       Fr.                             &lt;NA&gt; French Southern and Antarctic Lands
## 8                            Commonwealth of Australia      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                           Australia
## 9                                  Republic of Austria      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                             Austria
##   name_alt mapcolor7 mapcolor8 mapcolor9 mapcolor13  pop_est gdp_md_est pop_year lastcensus gdp_year                    economy
## 0     &lt;NA&gt;         5         6         8          7 28400000    22270.0       NA       1979       NA  7. Least developed region
## 1     &lt;NA&gt;         3         2         6          1 12799293   110300.0       NA       1970       NA  7. Least developed region
## 2     &lt;NA&gt;         1         4         1          6  3639453    21810.0       NA       2001       NA       6. Developing region
## 3     &lt;NA&gt;         2         1         3          3  4798491   184300.0       NA       2010       NA       6. Developing region
## 4     &lt;NA&gt;         3         1         3         13 40913584   573900.0       NA       2010       NA    5. Emerging region: G20
## 5     &lt;NA&gt;         3         1         2         10  2967004    18770.0       NA       2001       NA       6. Developing region
## 6     &lt;NA&gt;         4         5         1         NA     3802      760.4       NA         NA       NA       6. Developing region
## 7     &lt;NA&gt;         7         5         9         11      140       16.0       NA         NA       NA       6. Developing region
## 8     &lt;NA&gt;         1         2         2          7 21262641   800200.0       NA       2006       NA 2. Developed region: nonG7
## 9     &lt;NA&gt;         3         1         3          4  8210281   329500.0       NA       2011       NA 2. Developed region: nonG7
##                income_grp wikipedia fips_10 iso_a2 iso_a3 iso_n3 un_a3 wb_a2 wb_a3 woe_id adm0_a3_is adm0_a3_us adm0_a3_un adm0_a3_wb
## 0           5. Low income        NA    &lt;NA&gt;     AF    AFG    004   004    AF   AFG     NA        AFG        AFG         NA         NA
## 1  3. Upper middle income        NA    &lt;NA&gt;     AO    AGO    024   024    AO   AGO     NA        AGO        AGO         NA         NA
## 2  4. Lower middle income        NA    &lt;NA&gt;     AL    ALB    008   008    AL   ALB     NA        ALB        ALB         NA         NA
## 3 2. High income: nonOECD        NA    &lt;NA&gt;     AE    ARE    784   784    AE   ARE     NA        ARE        ARE         NA         NA
## 4  3. Upper middle income        NA    &lt;NA&gt;     AR    ARG    032   032    AR   ARG     NA        ARG        ARG         NA         NA
## 5  4. Lower middle income        NA    &lt;NA&gt;     AM    ARM    051   051    AM   ARM     NA        ARM        ARM         NA         NA
## 6 2. High income: nonOECD        NA    &lt;NA&gt;     AQ    ATA    010  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     NA        ATA        ATA         NA         NA
## 7 2. High income: nonOECD        NA    &lt;NA&gt;     TF    ATF    260  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     NA        ATF        ATF         NA         NA
## 8    1. High income: OECD        NA    &lt;NA&gt;     AU    AUS    036   036    AU   AUS     NA        AUS        AUS         NA         NA
## 9    1. High income: OECD        NA    &lt;NA&gt;     AT    AUT    040   040    AT   AUT     NA        AUT        AUT         NA         NA
##                 continent               region_un                 subregion                  region_wb name_len long_len abbrev_len tiny
## 0                    Asia                    Asia             Southern Asia                 South Asia       11       11          4   NA
## 1                  Africa                  Africa             Middle Africa         Sub-Saharan Africa        6        6          4   NA
## 2                  Europe                  Europe           Southern Europe      Europe &amp; Central Asia        7        7          4   NA
## 3                    Asia                    Asia              Western Asia Middle East &amp; North Africa       20       20          6   NA
## 4           South America                Americas             South America  Latin America &amp; Caribbean        9        9          4   NA
## 5                    Asia                    Asia              Western Asia      Europe &amp; Central Asia        7        7          4   NA
## 6              Antarctica              Antarctica                Antarctica                 Antarctica       10       10          4   NA
## 7 Seven seas (open ocean) Seven seas (open ocean)   Seven seas (open ocean)         Sub-Saharan Africa       22       35         10    2
## 8                 Oceania                 Oceania Australia and New Zealand        East Asia &amp; Pacific        9        9          4   NA
## 9                  Europe                  Europe            Western Europe      Europe &amp; Central Asia        7        7          5   NA
##   homepart                       geometry
## 0        1 MULTIPOLYGON (((61.21082 35...
## 1        1 MULTIPOLYGON (((16.32653 -5...
## 2        1 MULTIPOLYGON (((20.59025 41...
## 3        1 MULTIPOLYGON (((51.57952 24...
## 4        1 MULTIPOLYGON (((-65.5 -55.2...
## 5        1 MULTIPOLYGON (((43.58275 41...
## 6        1 MULTIPOLYGON (((-59.57209 -...
## 7       NA MULTIPOLYGON (((68.935 -48....
## 8        1 MULTIPOLYGON (((145.398 -40...
## 9        1 MULTIPOLYGON (((16.97967 48...
```

---

# 6. Converter objetos para sf

## Converter `sf` para `sp`


```r
# plot
plot(co110_sf$geometry, col = "gray", main = NA, graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-69-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

# 6. Converter objetos para sf

## Converter `sf` para `sp`


```r
# paises sp
co110_sp &lt;- sf::as_Spatial(co110_sf)
co110_sp
```

```
## class       : SpatialPolygonsDataFrame 
## features    : 177 
## extent      : -180, 180, -90, 83.64513  (xmin, xmax, ymin, ymax)
## crs         : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs 
## variables   : 63
## names       : scalerank,      featurecla, labelrank,  sovereignt, sov_a3, adm0_dif, level,              type,       admin, adm0_a3, geou_dif,     geounit, gu_a3, su_dif,     subunit, ... 
## min values  :         1, Admin-0 country,         2, Afghanistan,    AFG,        0,     2,           Country, Afghanistan,     AFG,        0, Afghanistan,   AFG,      0, Afghanistan, ... 
## max values  :         3, Admin-0 country,         7,    Zimbabwe,    ZWE,        1,     2, Sovereign country,    Zimbabwe,     ZWE,        0,    Zimbabwe,   ZWE,      1,    Zimbabwe, ...
```

---

# 7. Converter CRS de objetos sf

## Os principais CRSs

&lt;br&gt;

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; CRS &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Tipo de CRS &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Descri√ß√£o &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; epsg.io &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; spatialreference.org &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; WGS84 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Geogr√°fico &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CRS geogr√°fico mais comum para o mundo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:4326](http://epsg.io/4326) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:4326](https://spatialreference.org/ref/epsg/4326/) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; SIRGAS 2000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Geogr√°fico &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CRS geogr√°fico oficial para o Brasil &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:4674](http://epsg.io/4674) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:4674](https://spatialreference.org/ref/epsg/4674/) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Proje√ß√£o de Mollweide &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Projetado &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CRS projetado que  preserva as rela√ß√µes de √°rea &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [ESRI:54009](https://epsg.io/54009) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [SR-ORG:7099](https://spatialreference.org/ref/sr-org/7099/) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Proje√ß√£o de Winkel Tripel &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Projetado &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CRS projetado que preserva a √°rea e com meridianos el√≠pticos &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:54012](https://epsg.io/54012) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [ESRI:54012](https://spatialreference.org/ref/esri/54012/) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Proje√ß√£o C√¥nica de Albers &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Projetado &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CRS projetado para escala regional, mantendo a √°rea constante em toda sua superf√≠cie &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [SR-ORG:7823](https://spatialreference.org/ref/sr-org/7823/) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; UTM &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Projetado &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; CRS projetado para escala local, distorcendo √°reas e dist√¢ncias com a dist√¢ncia do centro da zona UTM &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:31983](https://epsg.io/31983) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; [EPSG:31983](https://spatialreference.org/ref/epsg/31983/) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

background-image: url(img/geo_proj_sirgas2000.png)
background-size: 200px
background-position: 50% 75%

# 7. Converter CRS de objetos sf

## Converter CRS local

### SIRGAS2000/GCS -&gt; SIRGAS2000/UTM23S


```r
# converter sistema de coordenadas
rc_2020_sirgas2000_utm23s &lt;- sf::st_transform(rc_2020, crs = 31983)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[EPSG: 31983](https://epsg.io/31983)
[SIRGAS2000](http://www.sirgas.org/pt/sirgas-realizations/sirgas2000/)

---

# 7. Converter CRS de objetos sf

## Converter CRS local

### SIRGAS2000/GCS -&gt; SIRGAS2000/UTM23S

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-73-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_utm_zones.png)
background-size: 500px
background-position: 50% 75%

# 7. Converter CRS de objetos sf

## Converter CRS local

### SIRGAS2000/GCS -&gt; WGS84/UTM23S


```r
# converter sistema de coordenadas e datum
rc_2020_wgs84_utm23s &lt;- sf::st_transform(rc_2020, crs = 32723)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[EPSG: 32723](https://epsg.io/32723)
[ESRI (2021)](https://pro.arcgis.com/en/pro-app/help/mapping/properties/transverse-mercator.htm)

---

background-image: url(img/geo_geographic.png)
background-size: 500px
background-position: 50% 80%

# 7. Converter CRS de objetos sf

## Converter CRS local

### SIRGAS2000/GCS -&gt; WGS84/GCS


```r
# converter datum
rc_2020_wgs84_gcs &lt;- sf::st_transform(rc_2020, crs = 4326)
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[EPSG: 4326](https://epsg.io/4326)

---

# 7. Converter CRS de objetos sf

## Converter CRS global


```r
# paises - WGS84/GCS
co110_sf
```

```
## Simple feature collection with 177 features and 63 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 83.64513
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
## First 10 features:
##   scalerank      featurecla labelrank           sovereignt sov_a3 adm0_dif level              type                               admin adm0_a3
## 0         1 Admin-0 country         3          Afghanistan    AFG        0     2 Sovereign country                         Afghanistan     AFG
## 1         1 Admin-0 country         3               Angola    AGO        0     2 Sovereign country                              Angola     AGO
## 2         1 Admin-0 country         6              Albania    ALB        0     2 Sovereign country                             Albania     ALB
## 3         1 Admin-0 country         4 United Arab Emirates    ARE        0     2 Sovereign country                United Arab Emirates     ARE
## 4         1 Admin-0 country         2            Argentina    ARG        0     2 Sovereign country                           Argentina     ARG
## 5         1 Admin-0 country         6              Armenia    ARM        0     2 Sovereign country                             Armenia     ARM
## 6         1 Admin-0 country         4           Antarctica    ATA        0     2     Indeterminate                          Antarctica     ATA
## 7         3 Admin-0 country         6               France    FR1        1     2        Dependency French Southern and Antarctic Lands     ATF
## 8         1 Admin-0 country         2            Australia    AU1        1     2           Country                           Australia     AUS
## 9         1 Admin-0 country         4              Austria    AUT        0     2 Sovereign country                             Austria     AUT
##   geou_dif                             geounit gu_a3 su_dif                             subunit su_a3 brk_diff                   name
## 0        0                         Afghanistan   AFG      0                         Afghanistan   AFG        0            Afghanistan
## 1        0                              Angola   AGO      0                              Angola   AGO        0                 Angola
## 2        0                             Albania   ALB      0                             Albania   ALB        0                Albania
## 3        0                United Arab Emirates   ARE      0                United Arab Emirates   ARE        0   United Arab Emirates
## 4        0                           Argentina   ARG      0                           Argentina   ARG        0              Argentina
## 5        0                             Armenia   ARM      0                             Armenia   ARM        0                Armenia
## 6        0                          Antarctica   ATA      0                          Antarctica   ATA        0             Antarctica
## 7        0 French Southern and Antarctic Lands   ATF      0 French Southern and Antarctic Lands   ATF        0 Fr. S. Antarctic Lands
## 8        0                           Australia   AUS      0                           Australia   AUS        0              Australia
## 9        0                             Austria   AUT      0                             Austria   AUT        0                Austria
##                             name_long brk_a3                   brk_name brk_group     abbrev postal
## 0                         Afghanistan    AFG                Afghanistan      &lt;NA&gt;       Afg.     AF
## 1                              Angola    AGO                     Angola      &lt;NA&gt;       Ang.     AO
## 2                             Albania    ALB                    Albania      &lt;NA&gt;       Alb.     AL
## 3                United Arab Emirates    ARE       United Arab Emirates      &lt;NA&gt;     U.A.E.     AE
## 4                           Argentina    ARG                  Argentina      &lt;NA&gt;       Arg.     AR
## 5                             Armenia    ARM                    Armenia      &lt;NA&gt;       Arm.    ARM
## 6                          Antarctica    ATA                 Antarctica      &lt;NA&gt;       Ant.     AQ
## 7 French Southern and Antarctic Lands    ATF Fr. S. and Antarctic Lands      &lt;NA&gt; Fr. S.A.L.     TF
## 8                           Australia    AUS                  Australia      &lt;NA&gt;       Auz.     AU
## 9                             Austria    AUT                    Austria      &lt;NA&gt;      Aust.      A
##                                              formal_en formal_fr note_adm0                         note_brk                           name_sort
## 0                         Islamic State of Afghanistan      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                         Afghanistan
## 1                          People's Republic of Angola      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                              Angola
## 2                                  Republic of Albania      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                             Albania
## 3                                 United Arab Emirates      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                United Arab Emirates
## 4                                   Argentine Republic      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                           Argentina
## 5                                  Republic of Armenia      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                             Armenia
## 6                                                 &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt; Multiple claims held in abeyance                          Antarctica
## 7 Territory of the French Southern and Antarctic Lands      &lt;NA&gt;       Fr.                             &lt;NA&gt; French Southern and Antarctic Lands
## 8                            Commonwealth of Australia      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                           Australia
## 9                                  Republic of Austria      &lt;NA&gt;      &lt;NA&gt;                             &lt;NA&gt;                             Austria
##   name_alt mapcolor7 mapcolor8 mapcolor9 mapcolor13  pop_est gdp_md_est pop_year lastcensus gdp_year                    economy
## 0     &lt;NA&gt;         5         6         8          7 28400000    22270.0       NA       1979       NA  7. Least developed region
## 1     &lt;NA&gt;         3         2         6          1 12799293   110300.0       NA       1970       NA  7. Least developed region
## 2     &lt;NA&gt;         1         4         1          6  3639453    21810.0       NA       2001       NA       6. Developing region
## 3     &lt;NA&gt;         2         1         3          3  4798491   184300.0       NA       2010       NA       6. Developing region
## 4     &lt;NA&gt;         3         1         3         13 40913584   573900.0       NA       2010       NA    5. Emerging region: G20
## 5     &lt;NA&gt;         3         1         2         10  2967004    18770.0       NA       2001       NA       6. Developing region
## 6     &lt;NA&gt;         4         5         1         NA     3802      760.4       NA         NA       NA       6. Developing region
## 7     &lt;NA&gt;         7         5         9         11      140       16.0       NA         NA       NA       6. Developing region
## 8     &lt;NA&gt;         1         2         2          7 21262641   800200.0       NA       2006       NA 2. Developed region: nonG7
## 9     &lt;NA&gt;         3         1         3          4  8210281   329500.0       NA       2011       NA 2. Developed region: nonG7
##                income_grp wikipedia fips_10 iso_a2 iso_a3 iso_n3 un_a3 wb_a2 wb_a3 woe_id adm0_a3_is adm0_a3_us adm0_a3_un adm0_a3_wb
## 0           5. Low income        NA    &lt;NA&gt;     AF    AFG    004   004    AF   AFG     NA        AFG        AFG         NA         NA
## 1  3. Upper middle income        NA    &lt;NA&gt;     AO    AGO    024   024    AO   AGO     NA        AGO        AGO         NA         NA
## 2  4. Lower middle income        NA    &lt;NA&gt;     AL    ALB    008   008    AL   ALB     NA        ALB        ALB         NA         NA
## 3 2. High income: nonOECD        NA    &lt;NA&gt;     AE    ARE    784   784    AE   ARE     NA        ARE        ARE         NA         NA
## 4  3. Upper middle income        NA    &lt;NA&gt;     AR    ARG    032   032    AR   ARG     NA        ARG        ARG         NA         NA
## 5  4. Lower middle income        NA    &lt;NA&gt;     AM    ARM    051   051    AM   ARM     NA        ARM        ARM         NA         NA
## 6 2. High income: nonOECD        NA    &lt;NA&gt;     AQ    ATA    010  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     NA        ATA        ATA         NA         NA
## 7 2. High income: nonOECD        NA    &lt;NA&gt;     TF    ATF    260  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;     NA        ATF        ATF         NA         NA
## 8    1. High income: OECD        NA    &lt;NA&gt;     AU    AUS    036   036    AU   AUS     NA        AUS        AUS         NA         NA
## 9    1. High income: OECD        NA    &lt;NA&gt;     AT    AUT    040   040    AT   AUT     NA        AUT        AUT         NA         NA
##                 continent               region_un                 subregion                  region_wb name_len long_len abbrev_len tiny
## 0                    Asia                    Asia             Southern Asia                 South Asia       11       11          4   NA
## 1                  Africa                  Africa             Middle Africa         Sub-Saharan Africa        6        6          4   NA
## 2                  Europe                  Europe           Southern Europe      Europe &amp; Central Asia        7        7          4   NA
## 3                    Asia                    Asia              Western Asia Middle East &amp; North Africa       20       20          6   NA
## 4           South America                Americas             South America  Latin America &amp; Caribbean        9        9          4   NA
## 5                    Asia                    Asia              Western Asia      Europe &amp; Central Asia        7        7          4   NA
## 6              Antarctica              Antarctica                Antarctica                 Antarctica       10       10          4   NA
## 7 Seven seas (open ocean) Seven seas (open ocean)   Seven seas (open ocean)         Sub-Saharan Africa       22       35         10    2
## 8                 Oceania                 Oceania Australia and New Zealand        East Asia &amp; Pacific        9        9          4   NA
## 9                  Europe                  Europe            Western Europe      Europe &amp; Central Asia        7        7          5   NA
##   homepart                       geometry
## 0        1 MULTIPOLYGON (((61.21082 35...
## 1        1 MULTIPOLYGON (((16.32653 -5...
## 2        1 MULTIPOLYGON (((20.59025 41...
## 3        1 MULTIPOLYGON (((51.57952 24...
## 4        1 MULTIPOLYGON (((-65.5 -55.2...
## 5        1 MULTIPOLYGON (((43.58275 41...
## 6        1 MULTIPOLYGON (((-59.57209 -...
## 7       NA MULTIPOLYGON (((68.935 -48....
## 8        1 MULTIPOLYGON (((145.398 -40...
## 9        1 MULTIPOLYGON (((16.97967 48...
```

---

# 7. Converter CRS de objetos sf

## Converter CRS global


```r
# plot
plot(co110_sf$geometry, col = "gray", graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-77-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_proj_moll.png)
background-size: 450px
background-position: 50% 70%

# 7. Converter CRS de objetos sf

## Converter CRS global

### Proje√ß√£o de Mollweide: preserva as rela√ß√µes de √°rea


```r
# projecao mollweide 
co110_sf_moll &lt;- sf::st_transform(co110_sf, crs = "+proj=moll")
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[EPSG: 54009](https://epsg.io/54009)
[ESRI (2021)](https://pro.arcgis.com/en/pro-app/help/mapping/properties/mollweide.html)

---

# 7. Converter CRS de objetos sf

## Converter CRS global

### Proje√ß√£o de Mollweide


```r
# plot
plot(co110_sf_moll$geometry, col = "gray", graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-79-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_proj_laea.png)
background-size: 200px
background-position: 50% 80%

# 7. Converter CRS de objetos sf

## Converter CRS global

### Proje√ß√£o azimutal de Lambert: preserva os tamanhos relativos e senso de dire√ß√£o a partir do centro


```r
# projecao lambert
co110_sf_laea &lt;- sf::st_transform(co110_sf, crs = "+proj=laea +x_0=0 +y_0=0 +lon_0=0 +lat_0=0")
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[ESRI(2021)](https://pro.arcgis.com/en/pro-app/help/mapping/properties/lambert-azimuthal-equal-area.html)

---

# 7. Converter CRS de objetos sf

## Converter CRS global

### Proje√ß√£o azimutal de Lambert


```r
# plot
plot(co110_sf_laea$geometry, col = "gray", graticule = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-81-1.png" width="40%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_sf_operations.png)
background-size: 400px
background-position: 50% 90%

# 8. Opera√ß√µes com objetos sf

## As opera√ß√µes podem ser separadas em tr√™s tipos

### 1. **Opera√ß√µes de atributos** (informa√ß√µes n√£o espaciais, como tabela de atributos)
### 2. **Opera√ß√µes espaciais** (informa√ß√µes espaciais, como localiza√ß√£o e formato)
### 3. **Opera√ß√µes geom√©tricas** (informa√ß√µes geom√©tricas, como mudan√ßas geom√©tricas un√°rias e bin√°rias)

---

background-image: url(img/geo_attribute_table.jpg)
background-size: 350px
background-position: 75% 70%

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### Modifica√ß√£o de objetos espaciais baseado em **informa√ß√µes n√£o espaciais** associadas a objetos sf

### **Opera√ß√µes**

### 1. Filtro
### 2. Jun√ß√£o
### 3. Agrega√ß√£o
### 4. Manipula√ß√£o da tabela de atributos

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.1 Filtro


```r
# filtro
rc_cob_floresta &lt;- rc_cob %&gt;% 
  dplyr::filter(CLASSE_USO == "forma√ß√£o florestal")
rc_cob_floresta
```

```
## Simple feature collection with 1 feature and 6 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 215442.4 ymin: 7504235 xmax: 246282.3 ymax: 7537969
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO AREA_HA                       geometry
## 1   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 MULTIPOLYGON (((232355 7504...
```

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.1 Filtro


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_cob_floresta$geometry, col = "forestgreen", add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-83-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.2 Jun√ß√£o


```r
# dados
da_classes &lt;- tibble::tibble(CLASSE_USO = rc_cob$CLASSE_USO, 
                             classe = c("agua", "antropico", "edificado", "floresta", "silvicultura"))
da_classes
```

```
## [90m# A tibble: 5 √ó 2[39m
##   CLASSE_USO         classe      
##   [3m[90m&lt;chr&gt;[39m[23m              [3m[90m&lt;chr&gt;[39m[23m       
## [90m1[39m √°gua               agua        
## [90m2[39m √°rea antropizada   antropico   
## [90m3[39m √°rea edificada     edificado   
## [90m4[39m forma√ß√£o florestal floresta    
## [90m5[39m silvicultura       silvicultura
```

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.2 Jun√ß√£o


```r
# juncao
rc_cob_classes &lt;- dplyr::left_join(rc_cob, da_classes, by = "CLASSE_USO") %&gt;% 
  sf::st_drop_geometry()
rc_cob_classes
```

```
##   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA       classe
## 1   3543907 RIO CLARO SP    35               √°gua   357.027         agua
## 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800    antropico
## 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330    edificado
## 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990     floresta
## 5   3543907 RIO CLARO SP    35       silvicultura   138.173 silvicultura
```

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.3 Agrega√ß√£o


```r
# agregar
rc_nas_n &lt;- rc_nas %&gt;% 
  dplyr::group_by(MUNICIPIO, HIDRO) %&gt;% 
  dplyr::summarise(n = n())
rc_nas_n
```

```
## Simple feature collection with 1 feature and 3 fields
## Geometry type: MULTIPOINT
## Dimension:     XY
## Bounding box:  xmin: 217622.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## [90m# A tibble: 1 √ó 4[39m
## [90m# Groups:   MUNICIPIO [1][39m
##   MUNICIPIO HIDRO        n                                                                                  geometry
##   [3m[90m&lt;chr&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m    [3m[90m&lt;int&gt;[39m[23m                                                                          [3m[90m&lt;MULTIPOINT [m]&gt;[39m[23m
## [90m1[39m RIO CLARO nascente  [4m1[24m220 ((217622.9 7528315), (217836.5 7528103), (217988.9 7528203), (218288.9 7528237), (2183...
```

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.3 Agrega√ß√£o


```r
# plot 
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_nas_n$geometry, pch = 20, col = "blue", add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-87-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.4 Manipula√ß√£o da tabela de atributos


```r
# criar coluna
rc_cob_cob_col_area &lt;- rc_cob %&gt;% 
  dplyr::mutate(classe_area = paste0(CLASSE_USO, " (", AREA_HA, " ha)")) %&gt;% 
  sf::st_drop_geometry()
rc_cob_cob_col_area
```

```
##   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA                     classe_area
## 1   3543907 RIO CLARO SP    35               √°gua   357.027               √°gua (357.027 ha)
## 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800   √°rea antropizada (37297.8 ha)
## 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330     √°rea edificada (5078.33 ha)
## 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990 forma√ß√£o florestal (7017.99 ha)
## 5   3543907 RIO CLARO SP    35       silvicultura   138.173       silvicultura (138.173 ha)
```

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.4 Manipula√ß√£o da tabela de atributos


```r
# comprimento das linhas
rc_hid_comp &lt;- rc_hid %&gt;% 
  dplyr::mutate(comprimento = sf::st_length(.))
rc_hid_comp
```

```
## Simple feature collection with 1 feature and 7 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: 215155.3 ymin: 7504132 xmax: 246367.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF                  HIDRO COMP_KM                       geometry comprimento
## 1   3543907 RIO CLARO SP    35 curso d'√°gua (0 - 10m) 1142.98 MULTILINESTRING ((231815.7 ... 1142981 [m]
```

---

# 8. Opera√ß√µes com objetos sf

## 1. Opera√ß√µes de atributos

### 1.4 Manipula√ß√£o da tabela de atributos


```r
# area das poligonos
rc_cob_area &lt;- rc_cob %&gt;% 
  dplyr::mutate(area_m2 = sf::st_area(.))
rc_cob_area
```

```
## Simple feature collection with 5 features and 7 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 215151.7 ymin: 7503723 xmax: 246582.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO   AREA_HA                       geometry         area_m2
## 1   3543907 RIO CLARO SP    35               √°gua   357.027 MULTIPOLYGON (((235487.6 75...   3570267 [m^2]
## 2   3543907 RIO CLARO SP    35   √°rea antropizada 37297.800 MULTIPOLYGON (((232275 7504... 372978415 [m^2]
## 3   3543907 RIO CLARO SP    35     √°rea edificada  5078.330 MULTIPOLYGON (((233123.6 75...  50783283 [m^2]
## 4   3543907 RIO CLARO SP    35 forma√ß√£o florestal  7017.990 MULTIPOLYGON (((232355 7504...  70179895 [m^2]
## 5   3543907 RIO CLARO SP    35       silvicultura   138.173 MULTIPOLYGON (((243052.1 75...   1381726 [m^2]
```

---

background-image: url(img/geo_sf_spatial_join.webp)
background-size: 600px
background-position: 80% 75%

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### Modifica√ß√£o de objetos espaciais baseado na sua **localiza√ß√£o e formato**

### **Opera√ß√µes**

### 1. Filtro espacial
### 2. Jun√ß√£o espacial
### 3. Agrega√ß√£o espacial
### 4. Dist√¢ncia espacial

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial


```r
# filtro espacial
sf::st_intersects(x = rc_nas, y = rc_cob_floresta)
```

```
## Sparse geometry binary predicate list of length 1220, where the predicate was `intersects'
## first 10 elements:
##  1: 1
##  2: 1
##  3: (empty)
##  4: 1
##  5: (empty)
##  6: (empty)
##  7: (empty)
##  8: (empty)
##  9: 1
##  10: (empty)
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial - interno


```r
# filtro espacial - interno
rc_nas_floresta_int &lt;- rc_nas %&gt;% 
  dplyr::filter(sf::st_intersects(x = ., y = rc_cob_floresta, sparse = FALSE))
rc_nas_floresta_int
```

```
## Simple feature collection with 169 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 217622.9 ymin: 7505568 xmax: 246181.4 ymax: 7537185
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##    GEOCODIGO MUNICIPIO UF CD_UF    HIDRO                 geometry
## 1    3543907 RIO CLARO SP    35 nascente POINT (217622.9 7528315)
## 2    3543907 RIO CLARO SP    35 nascente POINT (217836.5 7528103)
## 3    3543907 RIO CLARO SP    35 nascente POINT (218288.9 7528237)
## 4    3543907 RIO CLARO SP    35 nascente POINT (218583.5 7528215)
## 5    3543907 RIO CLARO SP    35 nascente POINT (219062.2 7528499)
## 6    3543907 RIO CLARO SP    35 nascente POINT (219246.2 7529011)
## 7    3543907 RIO CLARO SP    35 nascente POINT (219554.5 7528573)
## 8    3543907 RIO CLARO SP    35 nascente POINT (220534.8 7528014)
## 9    3543907 RIO CLARO SP    35 nascente POINT (220754.5 7530181)
## 10   3543907 RIO CLARO SP    35 nascente POINT (220958.3 7526278)
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial [] - interno


```r
# filtro espacial com [] - interno
rc_nas_floresta_int &lt;- rc_nas[rc_cob_floresta, ]
rc_nas_floresta_int
```

```
## Simple feature collection with 169 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 217622.9 ymin: 7505568 xmax: 246181.4 ymax: 7537185
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##    GEOCODIGO MUNICIPIO UF CD_UF    HIDRO                 geometry
## 1    3543907 RIO CLARO SP    35 nascente POINT (217622.9 7528315)
## 2    3543907 RIO CLARO SP    35 nascente POINT (217836.5 7528103)
## 4    3543907 RIO CLARO SP    35 nascente POINT (218288.9 7528237)
## 9    3543907 RIO CLARO SP    35 nascente POINT (218583.5 7528215)
## 15   3543907 RIO CLARO SP    35 nascente POINT (219062.2 7528499)
## 19   3543907 RIO CLARO SP    35 nascente POINT (219246.2 7529011)
## 23   3543907 RIO CLARO SP    35 nascente POINT (219554.5 7528573)
## 46   3543907 RIO CLARO SP    35 nascente POINT (220534.8 7528014)
## 50   3543907 RIO CLARO SP    35 nascente POINT (220754.5 7530181)
## 54   3543907 RIO CLARO SP    35 nascente POINT (220958.3 7526278)
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial [] - interno


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_cob_floresta$geometry, col = "forestgreen", add = TRUE)
plot(rc_nas_floresta_int$geometry, col = "blue", pch = 20, cex = 1, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-94-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial - externo


```r
# filtro espacial - externo
rc_nas_floresta_ext &lt;- rc_nas %&gt;% 
  dplyr::filter(sf::st_disjoint(x = ., y = rc_cob_floresta, sparse = FALSE))
rc_nas_floresta_ext
```

```
## Simple feature collection with 1051 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 217988.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##    GEOCODIGO MUNICIPIO UF CD_UF    HIDRO                 geometry
## 1    3543907 RIO CLARO SP    35 nascente POINT (217988.9 7528203)
## 2    3543907 RIO CLARO SP    35 nascente POINT (218346.6 7530583)
## 3    3543907 RIO CLARO SP    35 nascente POINT (218393.1 7528031)
## 4    3543907 RIO CLARO SP    35 nascente POINT (218508.3 7528470)
## 5    3543907 RIO CLARO SP    35 nascente POINT (218535.4 7530642)
## 6    3543907 RIO CLARO SP    35 nascente POINT (218760.1 7530258)
## 7    3543907 RIO CLARO SP    35 nascente POINT (218821.1 7529750)
## 8    3543907 RIO CLARO SP    35 nascente POINT (218868.5 7529257)
## 9    3543907 RIO CLARO SP    35 nascente POINT (218919.2 7528697)
## 10   3543907 RIO CLARO SP    35 nascente POINT (218958.8 7527735)
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial [] - externo 


```r
# filtro espacial com [] - externo
rc_nas_floresta_ext &lt;- rc_nas[rc_cob_floresta, , op = st_disjoint]
rc_nas_floresta_ext
```

```
## Simple feature collection with 1051 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 217988.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##    GEOCODIGO MUNICIPIO UF CD_UF    HIDRO                 geometry
## 3    3543907 RIO CLARO SP    35 nascente POINT (217988.9 7528203)
## 5    3543907 RIO CLARO SP    35 nascente POINT (218346.6 7530583)
## 6    3543907 RIO CLARO SP    35 nascente POINT (218393.1 7528031)
## 7    3543907 RIO CLARO SP    35 nascente POINT (218508.3 7528470)
## 8    3543907 RIO CLARO SP    35 nascente POINT (218535.4 7530642)
## 10   3543907 RIO CLARO SP    35 nascente POINT (218760.1 7530258)
## 11   3543907 RIO CLARO SP    35 nascente POINT (218821.1 7529750)
## 12   3543907 RIO CLARO SP    35 nascente POINT (218868.5 7529257)
## 13   3543907 RIO CLARO SP    35 nascente POINT (218919.2 7528697)
## 14   3543907 RIO CLARO SP    35 nascente POINT (218958.8 7527735)
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.1 Filtro espacial


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_cob_floresta$geometry, col = "forestgreen", add = TRUE)
plot(rc_nas_floresta_ext$geometry, col = "steelblue", pch = 20, cex = 1, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-97-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.2 Jun√ß√£o espacial


```r
# juncao espacial
rc_nas_cob_jun &lt;- rc_nas %&gt;% 
  sf::st_join(x = ., y = rc_cob) %&gt;% 
  dplyr::group_by(CLASSE_USO) %&gt;% 
  dplyr::summarise(n = n())
rc_nas_cob_jun
```

```
## Simple feature collection with 5 features and 2 fields
## Geometry type: MULTIPOINT
## Dimension:     XY
## Bounding box:  xmin: 217622.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## [90m# A tibble: 5 √ó 3[39m
##   CLASSE_USO             n                                                                                  geometry
##   [3m[90m&lt;chr&gt;[39m[23m              [3m[90m&lt;int&gt;[39m[23m                                                                          [3m[90m&lt;MULTIPOINT [m]&gt;[39m[23m
## [90m1[39m √°gua                   7 ((224989.9 7527331), (226855.6 7518588), (226859.8 7518617), (227604.7 7516271), (2331...
## [90m2[39m √°rea antropizada    [4m1[24m027 ((217988.9 7528203), (218346.6 7530583), (218393.1 7528031), (218508.3 7528470), (2185...
## [90m3[39m √°rea edificada        15 ((230717 7522791), (231255.1 7520519), (231420.5 7520332), (232278.7 7516953), (233685...
## [90m4[39m forma√ß√£o florestal   169 ((217622.9 7528315), (217836.5 7528103), (218288.9 7528237), (218583.5 7528215), (2190...
## [90m5[39m silvicultura           2                                                  ((242677.3 7535898), (242885.6 7535759))
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.2 Jun√ß√£o espacial


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_nas_cob_jun[1], col = c("blue", "orange", "gray30", "forestgreen", "green"), pch = 20, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-99-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.3 Agrega√ß√£o espacial


```r
# agregacao espacial
rc_cob_nas_agre &lt;- rc_nas %&gt;% 
  aggregate(x = ., by = rc_cob, FUN = length)
rc_cob_nas_agre
```

```
## Simple feature collection with 5 features and 5 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 215151.7 ymin: 7503723 xmax: 246582.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO   UF CD_UF HIDRO                       geometry
## 1         7         7    7     7     7 MULTIPOLYGON (((235487.6 75...
## 2      1027      1027 1027  1027  1027 MULTIPOLYGON (((232275 7504...
## 3        15        15   15    15    15 MULTIPOLYGON (((233123.6 75...
## 4       169       169  169   169   169 MULTIPOLYGON (((232355 7504...
## 5         2         2    2     2     2 MULTIPOLYGON (((243052.1 75...
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.3 Agrega√ß√£o espacial


```r
# plot
plot(rc_cob_nas_agre[1], axes = TRUE, graticule = TRUE, main = NA)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-101-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.4 Dist√¢ncia espacial


```r
# distancia
rc_nas_dist_flo &lt;- rc_nas %&gt;% 
  dplyr::mutate(dist_flo = sf::st_distance(rc_nas, rc_cob_floresta))
rc_nas_dist_flo
```

```
## Simple feature collection with 1220 features and 6 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 217622.9 ymin: 7504132 xmax: 246367.4 ymax: 7537855
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##    GEOCODIGO MUNICIPIO UF CD_UF    HIDRO                 geometry      dist_flo
## 1    3543907 RIO CLARO SP    35 nascente POINT (217622.9 7528315)   0.00000 [m]
## 2    3543907 RIO CLARO SP    35 nascente POINT (217836.5 7528103)   0.00000 [m]
## 3    3543907 RIO CLARO SP    35 nascente POINT (217988.9 7528203)  37.41369 [m]
## 4    3543907 RIO CLARO SP    35 nascente POINT (218288.9 7528237)   0.00000 [m]
## 5    3543907 RIO CLARO SP    35 nascente POINT (218346.6 7530583) 714.91131 [m]
## 6    3543907 RIO CLARO SP    35 nascente POINT (218393.1 7528031)  21.87610 [m]
## 7    3543907 RIO CLARO SP    35 nascente POINT (218508.3 7528470)   0.44820 [m]
## 8    3543907 RIO CLARO SP    35 nascente POINT (218535.4 7530642) 541.45390 [m]
## 9    3543907 RIO CLARO SP    35 nascente POINT (218583.5 7528215)   0.00000 [m]
## 10   3543907 RIO CLARO SP    35 nascente POINT (218760.1 7530258) 297.01502 [m]
```

---

# 8. Opera√ß√µes com objetos sf

## 2 Opera√ß√µes espaciais

### 2.4 Dist√¢ncia espacial


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_cob_floresta$geometry, col = "forestgreen", add = TRUE)
plot(rc_nas_dist_flo[7], pch = 20, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-103-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_sf_simplify.png), url(img/geo_sf_venn.png)
background-size: 400px, 500px
background-position: 90% 85%, 50% 55%

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### Modifica√ß√£o de objetos espaciais baseado em opera√ß√µes que mudam a **geometria do vetor**

### **Opera√ß√µes**

1. Simplifica√ß√£o
1. Centroides
1. Pontos aleat√≥rios
1. Buffers
1. Pol√≠gono convexo
1. Pol√≠gonos de Voronoi
1. Quadr√≠culas e hex√°gonos
1. Uni√£o ("dissolver")
1. Recorte ("clipar")
1. Transforma√ß√µes de tipo

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.1 Simplifica√ß√£o


```r
# simplificacao
rc_hid_simplificado &lt;- sf::st_simplify(x = rc_hid, dTolerance = 1000)
rc_hid_simplificado
```

```
## Simple feature collection with 1 feature and 6 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: 215155.3 ymin: 7504132 xmax: 246367.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF                  HIDRO COMP_KM                       geometry
## 1   3543907 RIO CLARO SP    35 curso d'√°gua (0 - 10m) 1142.98 MULTILINESTRING ((231815.7 ...
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.1 Simplifica√ß√£o


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_hid$geometry, col = "steelblue", lwd = 2, add = TRUE)
plot(rc_hid_simplificado$geometry, col = adjustcolor("black", .7), add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-105-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.2 Centroides


```r
# centroides
rc_2020_sirgas2000_utm23s_cent &lt;- sf::st_centroid(rc_2020_sirgas2000_utm23s)
rc_2020_sirgas2000_utm23s_cent
```

```
## Simple feature collection with 1 feature and 7 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 234338.3 ymin: 7523516 xmax: 234338.3 ymax: 7523516
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##     code_muni name_muni code_state abbrev_state name_state code_region name_region                     geom
## 493   3543907 Rio Claro         35           SP  S√£o Paulo           3     Sudeste POINT (234338.3 7523516)
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.2 Centroides


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_cent$geom, cex = 3, pch = 20, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-107-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.3 Pontos aleat√≥rios


```r
# fixar amostragem
set.seed(42)

# pontos aleatorios
rc_2020_sirgas2000_utm23s_pontos_aleatorios &lt;- sf::st_sample(rc_2020_sirgas2000_utm23s, size = 30)
rc_2020_sirgas2000_utm23s_pontos_aleatorios
```

```
## Geometry set for 30 features 
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 223360.4 ymin: 7505201 xmax: 243540.8 ymax: 7536696
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 5 geometries:
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.3 Pontos aleat√≥rios


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios, pch = 20, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-109-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.4 Buffer


```r
# buffer
rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer &lt;- sf::st_buffer(x = rc_2020_sirgas2000_utm23s_pontos_aleatorios, dist = 1000)
rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer
```

```
## Geometry set for 30 features 
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 222360.4 ymin: 7504201 xmax: 244540.8 ymax: 7537696
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 5 geometries:
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.4 Buffer


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer, col = NA, lwd = 2, border = "red", add = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-111-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.5 Pol√≠gono convexo


```r
# poligono convexo
rc_2020_sirgas2000_utm23s_convexo &lt;- rc_2020_sirgas2000_utm23s_pontos_aleatorios %&gt;% 
  sf::st_union() %&gt;% 
  sf::st_convex_hull()
rc_2020_sirgas2000_utm23s_convexo 
```

```
## Geometry set for 1 feature 
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 223360.4 ymin: 7505201 xmax: 243540.8 ymax: 7536696
## Projected CRS: SIRGAS 2000 / UTM zone 23S
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.5 Pol√≠gono convexo


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_convexo, col = NA, lwd = 2, border = "red", add = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-113-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.6 Pol√≠gonos de Voronoi


```r
# poligono de voronoi
rc_2020_sirgas2000_utm23s_voronoi &lt;- rc_2020_sirgas2000_utm23s_pontos_aleatorios %&gt;% 
  sf::st_union() %&gt;% 
  sf::st_voronoi()
rc_2020_sirgas2000_utm23s_voronoi
```

```
## Geometry set for 1 feature 
## Geometry type: GEOMETRYCOLLECTION
## Dimension:     XY
## Bounding box:  xmin: 191865.2 ymin: 7473706 xmax: 275036.1 ymax: 7568192
## Projected CRS: SIRGAS 2000 / UTM zone 23S
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.6 Pol√≠gonos de Voronoi


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_voronoi, col = NA, lwd = 2, border = "red", add = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios, pch = 20, cex = 1, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-115-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.7 Quadr√≠culas e hex√°gonos


```r
# quadriculas
rc_2020_sirgas2000_utm23s_grid &lt;- sf::st_make_grid(x = rc_2020_sirgas2000_utm23s, cellsize = 2000, what = "polygons") %&gt;%
  sf::st_as_sf() %&gt;%
  dplyr::filter(sf::st_intersects(x = ., y = rc_2020_sirgas2000_utm23s, sparse = FALSE))

# centroides das quadriculas
rc_2020_sirgas2000_utm23s_grid_cent &lt;- rc_2020_sirgas2000_utm23s %&gt;% 
  sf::st_make_grid(cellsize = 2000, what = "centers") %&gt;%
  sf::st_as_sf() %&gt;%
  dplyr::filter(sf::st_intersects(x = ., y = sf::st_union(rc_2020_sirgas2000_utm23s_grid), sparse = FALSE))
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.7 Quadr√≠culas e hex√°gonos


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_grid, col = NA, border = "red", lwd = 2, add = TRUE)
plot(rc_2020_sirgas2000_utm23s_grid_cent, pch = 20, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-117-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.7 Quadr√≠culas e hex√°gonos


```r
# hexagonos
rc_2020_sirgas2000_utm23s_hex &lt;- rc_2020_sirgas2000_utm23s %&gt;% 
  sf::st_make_grid(cellsize = 2000, square = FALSE) %&gt;% 
  sf::st_as_sf() %&gt;%
  dplyr::filter(sf::st_intersects(x = ., y = rc_2020_sirgas2000_utm23s, sparse = FALSE))

# centroides de hexagonos
rc_2020_sirgas2000_utm23s_hex_cent &lt;- rc_2020_sirgas2000_utm23s %&gt;% 
  sf::st_make_grid(cellsize = 2000, square = FALSE, what = "centers") %&gt;% 
  sf::st_as_sf() %&gt;% 
  dplyr::filter(sf::st_intersects(x = ., y = sf::st_union(rc_2020_sirgas2000_utm23s_hex), sparse = FALSE))
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.7 Quadr√≠culas e hex√°gonos


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_hex, col = NA, border = "red", lwd = 2, add = TRUE)
plot(rc_2020_sirgas2000_utm23s_hex_cent, pch = 20, add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-119-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.8 Uni√£o ("dissolver")


```r
# uniao
rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao &lt;- sf::st_union(rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer)
rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao
```

```
## Geometry set for 1 feature 
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 222360.4 ymin: 7504201 xmax: 244540.8 ymax: 7537696
## Projected CRS: SIRGAS 2000 / UTM zone 23S
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.8 Uni√£o ("dissolver")


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao, col = adjustcolor("blue", .1), add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-121-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.9 Recorte ("clipar")


```r
# recorte - interseccao
rc_hid_interseccao &lt;- sf::st_intersection(x = rc_hid, y = rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao)
rc_hid_interseccao
```

```
## Simple feature collection with 1 feature and 6 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: 222421.9 ymin: 7504269 xmax: 244527.4 ymax: 7537655
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF                  HIDRO COMP_KM                       geometry
## 1   3543907 RIO CLARO SP    35 curso d'√°gua (0 - 10m) 1142.98 MULTILINESTRING ((231820 75...
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.9 Recorte ("clipar")


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao, col = adjustcolor("blue", .1), add = TRUE)
plot(rc_hid_interseccao$geometry, col = "blue", add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-123-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.9 Recorte ("clipar") - diferen√ßa


```r
# recorte - diferenca
rc_hid_diferenca &lt;- sf::st_difference(x = rc_hid, y = rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao)
rc_hid_diferenca
```

```
## Simple feature collection with 1 feature and 6 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: 215155.3 ymin: 7504132 xmax: 246367.4 ymax: 7537978
## Projected CRS: SIRGAS 2000 / UTM zone 23S
##   GEOCODIGO MUNICIPIO UF CD_UF                  HIDRO COMP_KM                       geometry
## 1   3543907 RIO CLARO SP    35 curso d'√°gua (0 - 10m) 1142.98 MULTILINESTRING ((231815.7 ...
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.9 Recorte ("clipar") - diferen√ßa


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_2020_sirgas2000_utm23s_pontos_aleatorios_buffer_uniao, col = adjustcolor("blue", .1), add = TRUE)
plot(rc_hid_diferenca$geometry, col = "blue", add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-125-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.10 Transforma√ß√µes de tipo


```r
# transformacao de tipo
rc_cob_floresta_polygon &lt;- rc_cob_floresta %&gt;% 
  sf::st_cast("POLYGON") %&gt;% 
  dplyr::mutate(area_ha = sf::st_area(.)/1e4 %&gt;% round(2))
rc_cob_floresta_polygon
```

```
## Simple feature collection with 1732 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 215442.4 ymin: 7504235 xmax: 246282.3 ymax: 7537969
## Projected CRS: SIRGAS 2000 / UTM zone 23S
## First 10 features:
##     GEOCODIGO MUNICIPIO UF CD_UF         CLASSE_USO AREA_HA                       geometry            area_ha
## 1     3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((232355 7504440, 2... 3.232500e+00 [m^2]
## 1.1   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((229470 7505200, 2... 7.015000e+00 [m^2]
## 1.2   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((231185 7505305, 2... 2.992500e+00 [m^2]
## 1.3   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((232175 7505460, 2... 3.750002e-01 [m^2]
## 1.4   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((231720 7505435, 2... 5.017500e+00 [m^2]
## 1.5   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((228495 7505505, 2... 5.553675e-02 [m^2]
## 1.6   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((232120 7505525, 2... 3.275000e-01 [m^2]
## 1.7   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((228225 7505650, 2... 1.523472e-04 [m^2]
## 1.8   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((228215 7505655, 2... 3.237210e-04 [m^2]
## 1.9   3543907 RIO CLARO SP    35 forma√ß√£o florestal 7017.99 POLYGON ((229945 7504655, 2... 3.801250e+01 [m^2]
```

---

# 8. Opera√ß√µes com objetos sf

## 3 Opera√ß√µes geom√©tricas

### 3.10 Transforma√ß√µes de tipo


```r
# plot
plot(rc_2020_sirgas2000_utm23s$geom, col = "gray", main = NA, axes = TRUE, graticule = TRUE)
plot(rc_cob_floresta_polygon["area_ha"], col = viridis::viridis(100),  add = TRUE)
```

&lt;img src="07_slides_intro_geoespacial_r_files/figure-html/unnamed-chunk-127-1.png" width="30%" style="display: block; margin: auto;" /&gt;

---

background-image: url(img/geo_shp_logo.png), url(img/geo_shp_formats.png)
background-size: 150px, 450px
background-position: 50% 50%, 50% 85%

# 9. Exportar objetos sf

## Exportar como shapefile


```r
# exportar o vetor de floresta na extens√£o esri shapefile
sf::st_write(obj = rc_cob_floresta_polygon, dsn = here::here("03_dados", "vetor", "rc_cob_floresta_polygon.shp"))
```

---

background-image: url(img/geo_ban_shp.png), url(img/geo_geopackage.png)
background-size: 250px, 600px
background-position: 15% 65%, 85% 70%

# 9. Exportar objetos sf

## Exportar como geopackage


```r
# exportar o vetor de floresta na extens√£o geopackage
sf::st_write(obj = rc_cob_floresta_polygon, dsn = here::here("03_dados", "vetor", "vetores.gpkg"), layer = "rc_cob_floresta_polygon")
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[Switch from Shapefile](http://switchfromshapefile.org/),
[Using the Geopackage Format with R](https://jsta.rbind.io/blog/2016-07-14-geopackage-r/)

---

background-image: url(img/geo_ban_shp.png), url(img/geo_geopackage.png)
background-size: 250px, 600px
background-position: 15% 65%, 85% 70%

# 9. Exportar objetos sf

## Exportar como geopackage


```r
# exportar o vetor da america do sul na extens√£o geopackage
sf::st_write(obj = sa, dsn = here::here("03_dados", "vetor", "vetores.gpkg"), layer = "south_america")
```

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
[Switch from Shapefile](http://switchfromshapefile.org/),
[Using the Geopackage Format with R](https://jsta.rbind.io/blog/2016-07-14-geopackage-r/)

---

class: inverse, middle, center

# D√∫vidas?

---

class: clear, middle
background-image: url(img/gif_frog.gif),url(img/gif_frogs.gif), url(img/package_xaringan.png)
background-size: 250px, 500px, 130px
background-position: 35% 50%, 90% 55%, 5% 86%

## Maur√≠cio Vancine

&lt;br&gt;&lt;br&gt;

Contatos:

&lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#23373b;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"&gt;&lt;/path&gt;&lt;/svg&gt; [mauricio.vancine@gmail.com]()  
&lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#23373b;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"&gt;&lt;/path&gt;&lt;/svg&gt; [@mauriciovancine](https://twitter.com/mauriciovancine)  
&lt;svg viewBox="0 0 496 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#23373b;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"&gt;&lt;/path&gt;&lt;/svg&gt; [mauriciovancine](https://github.com/mauriciovancine)
&lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#23373b;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"&gt;&lt;/path&gt;&lt;/svg&gt; [mauriciovancine.github.io](https://mauriciovancine.github.io)

&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;

Slides criados via pacote [xaringan](https://github.com/yihui/xaringan) e tema [Metropolis](https://github.com/pat-s/xaringan-metropolis). Anima√ß√£o dos sapos por [@probzz](https://twitter.com/probzz/status/1367613720294170627).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "rainbow",
"highlightLines": false,
"highlightSpans": false,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%/%total%",
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
